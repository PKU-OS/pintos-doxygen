<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PKUOS - Pintos: src/devices/ide.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PKUOS - Pintos
   </div>
   <div id="projectbrief">Pintos source browser for PKU Operating System course</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_6fac9273c1f4413d2ee63ba6cd0b0eb2.html">devices</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ide.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="ide_8h_source.html">devices/ide.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="ctype_8h_source.html">ctype.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="debug_8h_source.html">debug.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="stdbool_8h_source.html">stdbool.h</a>&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &quot;<a class="el" href="block_8h_source.html">devices/block.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="partition_8h_source.html">devices/partition.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer_8h_source.html">devices/timer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="io_8h_source.html">threads/io.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interrupt_8h_source.html">threads/interrupt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="synch_8h_source.html">threads/synch.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ide.c:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c__incl.png" border="0" usemap="#asrc_2devices_2ide_8c" alt=""/></div>
<map name="asrc_2devices_2ide_8c" id="asrc_2devices_2ide_8c">
<area shape="rect" title=" " alt="" coords="482,5,602,32"/>
<area shape="rect" href="ide_8h.html" title=" " alt="" coords="5,80,105,107"/>
<area shape="rect" href="ctype_8h.html" title=" " alt="" coords="129,80,195,107"/>
<area shape="rect" href="debug_8h.html" title=" " alt="" coords="219,80,289,107"/>
<area shape="rect" href="stdbool_8h.html" title=" " alt="" coords="387,229,463,256"/>
<area shape="rect" title=" " alt="" coords="915,80,977,107"/>
<area shape="rect" href="block_8h.html" title=" " alt="" coords="777,80,891,107"/>
<area shape="rect" href="partition_8h.html" title=" " alt="" coords="1001,80,1131,107"/>
<area shape="rect" href="timer_8h.html" title=" " alt="" coords="590,80,702,107"/>
<area shape="rect" href="io_8h.html" title=" " alt="" coords="781,155,873,181"/>
<area shape="rect" href="interrupt_8h.html" title=" " alt="" coords="410,155,541,181"/>
<area shape="rect" href="synch_8h.html" title=" " alt="" coords="388,80,504,107"/>
<area shape="rect" href="stddef_8h.html" title=" " alt="" coords="793,229,862,256"/>
<area shape="rect" href="inttypes_8h.html" title=" " alt="" coords="897,155,976,181"/>
<area shape="rect" href="stdint_8h.html" title=" " alt="" coords="620,229,685,256"/>
<area shape="rect" href="round_8h.html" title=" " alt="" coords="690,155,757,181"/>
<area shape="rect" href="list_8h.html" title=" " alt="" coords="565,155,615,181"/>
</map>
</div>
</div>
<p><a href="ide_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structata__disk.html">ata_disk</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An ATA device.  <a href="structata__disk.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structchannel.html">channel</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An ATA channel (aka controller).  <a href="structchannel.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4063badbb8a8ae2e44ae6d2099b5f0d3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a4063badbb8a8ae2e44ae6d2099b5f0d3">reg_data</a>(CHANNEL)&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 0)</td></tr>
<tr class="memdesc:a4063badbb8a8ae2e44ae6d2099b5f0d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The code in this file is an interface to an ATA (IDE) controller.  <a href="ide_8c.html#a4063badbb8a8ae2e44ae6d2099b5f0d3">More...</a><br /></td></tr>
<tr class="separator:a4063badbb8a8ae2e44ae6d2099b5f0d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4452e5ae677c19dae7868616be5b25a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#ab4452e5ae677c19dae7868616be5b25a">reg_error</a>(CHANNEL)&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 1)</td></tr>
<tr class="memdesc:ab4452e5ae677c19dae7868616be5b25a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error.  <a href="ide_8c.html#ab4452e5ae677c19dae7868616be5b25a">More...</a><br /></td></tr>
<tr class="separator:ab4452e5ae677c19dae7868616be5b25a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5552d25f2cceca35f1390ec81072263c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a5552d25f2cceca35f1390ec81072263c">reg_nsect</a>(CHANNEL)&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 2)</td></tr>
<tr class="memdesc:a5552d25f2cceca35f1390ec81072263c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sector Count.  <a href="ide_8c.html#a5552d25f2cceca35f1390ec81072263c">More...</a><br /></td></tr>
<tr class="separator:a5552d25f2cceca35f1390ec81072263c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4779eaf99f72f15a3de118f1b32ffd2d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a4779eaf99f72f15a3de118f1b32ffd2d">reg_lbal</a>(CHANNEL)&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 3)</td></tr>
<tr class="memdesc:a4779eaf99f72f15a3de118f1b32ffd2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">LBA 0:7.  <a href="ide_8c.html#a4779eaf99f72f15a3de118f1b32ffd2d">More...</a><br /></td></tr>
<tr class="separator:a4779eaf99f72f15a3de118f1b32ffd2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af48b9ab28b218aaf86755ced4db35aa1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#af48b9ab28b218aaf86755ced4db35aa1">reg_lbam</a>(CHANNEL)&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 4)</td></tr>
<tr class="memdesc:af48b9ab28b218aaf86755ced4db35aa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">LBA 15:8.  <a href="ide_8c.html#af48b9ab28b218aaf86755ced4db35aa1">More...</a><br /></td></tr>
<tr class="separator:af48b9ab28b218aaf86755ced4db35aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bb66f5a8375377794d9895bf5f54b8f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a5bb66f5a8375377794d9895bf5f54b8f">reg_lbah</a>(CHANNEL)&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 5)</td></tr>
<tr class="memdesc:a5bb66f5a8375377794d9895bf5f54b8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">LBA 23:16.  <a href="ide_8c.html#a5bb66f5a8375377794d9895bf5f54b8f">More...</a><br /></td></tr>
<tr class="separator:a5bb66f5a8375377794d9895bf5f54b8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bd78e11470d9a7ffb6d720c9c3801b6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a1bd78e11470d9a7ffb6d720c9c3801b6">reg_device</a>(CHANNEL)&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 6)</td></tr>
<tr class="memdesc:a1bd78e11470d9a7ffb6d720c9c3801b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Device/LBA 27:24.  <a href="ide_8c.html#a1bd78e11470d9a7ffb6d720c9c3801b6">More...</a><br /></td></tr>
<tr class="separator:a1bd78e11470d9a7ffb6d720c9c3801b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77237dcfa9c18241804aeb5f1a75d030"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a77237dcfa9c18241804aeb5f1a75d030">reg_status</a>(CHANNEL)&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 7)</td></tr>
<tr class="memdesc:a77237dcfa9c18241804aeb5f1a75d030"><td class="mdescLeft">&#160;</td><td class="mdescRight">Status (r/o).  <a href="ide_8c.html#a77237dcfa9c18241804aeb5f1a75d030">More...</a><br /></td></tr>
<tr class="separator:a77237dcfa9c18241804aeb5f1a75d030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab99d71cce46b6e27fe03ca023d48056c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#ab99d71cce46b6e27fe03ca023d48056c">reg_command</a>(CHANNEL)&#160;&#160;&#160;<a class="el" href="ide_8c.html#a77237dcfa9c18241804aeb5f1a75d030">reg_status</a> (CHANNEL)</td></tr>
<tr class="memdesc:ab99d71cce46b6e27fe03ca023d48056c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Command (w/o).  <a href="ide_8c.html#ab99d71cce46b6e27fe03ca023d48056c">More...</a><br /></td></tr>
<tr class="separator:ab99d71cce46b6e27fe03ca023d48056c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a34473ff78753fa67a09fc8f34f3b81"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a0a34473ff78753fa67a09fc8f34f3b81">reg_ctl</a>(CHANNEL)&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 0x206)</td></tr>
<tr class="memdesc:a0a34473ff78753fa67a09fc8f34f3b81"><td class="mdescLeft">&#160;</td><td class="mdescRight">ATA control block port addresses.  <a href="ide_8c.html#a0a34473ff78753fa67a09fc8f34f3b81">More...</a><br /></td></tr>
<tr class="separator:a0a34473ff78753fa67a09fc8f34f3b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87589b087951334b384d285e1bf486c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a87589b087951334b384d285e1bf486c9">reg_alt_status</a>(CHANNEL)&#160;&#160;&#160;<a class="el" href="ide_8c.html#a0a34473ff78753fa67a09fc8f34f3b81">reg_ctl</a> (CHANNEL)</td></tr>
<tr class="memdesc:a87589b087951334b384d285e1bf486c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alt Status (r/o).  <a href="ide_8c.html#a87589b087951334b384d285e1bf486c9">More...</a><br /></td></tr>
<tr class="separator:a87589b087951334b384d285e1bf486c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d568d02d45d914c5839758673f0ece0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a9d568d02d45d914c5839758673f0ece0">STA_BSY</a>&#160;&#160;&#160;0x80</td></tr>
<tr class="memdesc:a9d568d02d45d914c5839758673f0ece0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alternate Status Register bits.  <a href="ide_8c.html#a9d568d02d45d914c5839758673f0ece0">More...</a><br /></td></tr>
<tr class="separator:a9d568d02d45d914c5839758673f0ece0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b14630ab1ade3cf9a53d8876f7288db"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a8b14630ab1ade3cf9a53d8876f7288db">STA_DRDY</a>&#160;&#160;&#160;0x40</td></tr>
<tr class="memdesc:a8b14630ab1ade3cf9a53d8876f7288db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Device Ready.  <a href="ide_8c.html#a8b14630ab1ade3cf9a53d8876f7288db">More...</a><br /></td></tr>
<tr class="separator:a8b14630ab1ade3cf9a53d8876f7288db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e968805f523a6eecdec3b1fe6ccbab"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a92e968805f523a6eecdec3b1fe6ccbab">STA_DRQ</a>&#160;&#160;&#160;0x08</td></tr>
<tr class="memdesc:a92e968805f523a6eecdec3b1fe6ccbab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data Request.  <a href="ide_8c.html#a92e968805f523a6eecdec3b1fe6ccbab">More...</a><br /></td></tr>
<tr class="separator:a92e968805f523a6eecdec3b1fe6ccbab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d55587e2b43fed1168972dcc963728"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a20d55587e2b43fed1168972dcc963728">CTL_SRST</a>&#160;&#160;&#160;0x04</td></tr>
<tr class="memdesc:a20d55587e2b43fed1168972dcc963728"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control Register bits.  <a href="ide_8c.html#a20d55587e2b43fed1168972dcc963728">More...</a><br /></td></tr>
<tr class="separator:a20d55587e2b43fed1168972dcc963728"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a980214a3ca249c5c0956b189e47a56f2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a980214a3ca249c5c0956b189e47a56f2">DEV_MBS</a>&#160;&#160;&#160;0xa0</td></tr>
<tr class="memdesc:a980214a3ca249c5c0956b189e47a56f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Device Register bits.  <a href="ide_8c.html#a980214a3ca249c5c0956b189e47a56f2">More...</a><br /></td></tr>
<tr class="separator:a980214a3ca249c5c0956b189e47a56f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8db654ddff6915da10cc09d0e14771"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a3a8db654ddff6915da10cc09d0e14771">DEV_LBA</a>&#160;&#160;&#160;0x40</td></tr>
<tr class="memdesc:a3a8db654ddff6915da10cc09d0e14771"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear based addressing.  <a href="ide_8c.html#a3a8db654ddff6915da10cc09d0e14771">More...</a><br /></td></tr>
<tr class="separator:a3a8db654ddff6915da10cc09d0e14771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a229d9c672119c31246cb5a46955252d0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a229d9c672119c31246cb5a46955252d0">DEV_DEV</a>&#160;&#160;&#160;0x10</td></tr>
<tr class="memdesc:a229d9c672119c31246cb5a46955252d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select device: 0=master, 1=slave.  <a href="ide_8c.html#a229d9c672119c31246cb5a46955252d0">More...</a><br /></td></tr>
<tr class="separator:a229d9c672119c31246cb5a46955252d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34785bd459d404747354fc4c5da3eeb2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a34785bd459d404747354fc4c5da3eeb2">CMD_IDENTIFY_DEVICE</a>&#160;&#160;&#160;0xec</td></tr>
<tr class="memdesc:a34785bd459d404747354fc4c5da3eeb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commands.  <a href="ide_8c.html#a34785bd459d404747354fc4c5da3eeb2">More...</a><br /></td></tr>
<tr class="separator:a34785bd459d404747354fc4c5da3eeb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3249b993cd9bee1a522ab7fe4fa2875"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#ac3249b993cd9bee1a522ab7fe4fa2875">CMD_READ_SECTOR_RETRY</a>&#160;&#160;&#160;0x20</td></tr>
<tr class="memdesc:ac3249b993cd9bee1a522ab7fe4fa2875"><td class="mdescLeft">&#160;</td><td class="mdescRight">READ SECTOR with retries.  <a href="ide_8c.html#ac3249b993cd9bee1a522ab7fe4fa2875">More...</a><br /></td></tr>
<tr class="separator:ac3249b993cd9bee1a522ab7fe4fa2875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab693c8ade8ea06207282a120c6a95b49"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#ab693c8ade8ea06207282a120c6a95b49">CMD_WRITE_SECTOR_RETRY</a>&#160;&#160;&#160;0x30</td></tr>
<tr class="memdesc:ab693c8ade8ea06207282a120c6a95b49"><td class="mdescLeft">&#160;</td><td class="mdescRight">WRITE SECTOR with retries.  <a href="ide_8c.html#ab693c8ade8ea06207282a120c6a95b49">More...</a><br /></td></tr>
<tr class="separator:ab693c8ade8ea06207282a120c6a95b49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed31f8d4617249f3a96e6038e652194e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#aed31f8d4617249f3a96e6038e652194e">CHANNEL_CNT</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:aed31f8d4617249f3a96e6038e652194e"><td class="mdescLeft">&#160;</td><td class="mdescRight">We support the two "legacy" ATA channels found in a standard PC.  <a href="ide_8c.html#aed31f8d4617249f3a96e6038e652194e">More...</a><br /></td></tr>
<tr class="separator:aed31f8d4617249f3a96e6038e652194e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a03eb0d9954faefcc1634f76a286f78f5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a03eb0d9954faefcc1634f76a286f78f5">reset_channel</a> (struct <a class="el" href="structchannel.html">channel</a> *c)</td></tr>
<tr class="memdesc:a03eb0d9954faefcc1634f76a286f78f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets an ATA channel and waits for any devices present on it to finish the reset.  <a href="ide_8c.html#a03eb0d9954faefcc1634f76a286f78f5">More...</a><br /></td></tr>
<tr class="separator:a03eb0d9954faefcc1634f76a286f78f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb1b543e585d7b5757bf9406b8705349"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#afb1b543e585d7b5757bf9406b8705349">check_device_type</a> (struct <a class="el" href="structata__disk.html">ata_disk</a> *d)</td></tr>
<tr class="memdesc:afb1b543e585d7b5757bf9406b8705349"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether device D is an ATA disk and sets D's is_ata member appropriately.  <a href="ide_8c.html#afb1b543e585d7b5757bf9406b8705349">More...</a><br /></td></tr>
<tr class="separator:afb1b543e585d7b5757bf9406b8705349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcd1cfa04037980c000c94c826517759"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#afcd1cfa04037980c000c94c826517759">identify_ata_device</a> (struct <a class="el" href="structata__disk.html">ata_disk</a> *d)</td></tr>
<tr class="memdesc:afcd1cfa04037980c000c94c826517759"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends an IDENTIFY DEVICE command to disk D and reads the response.  <a href="ide_8c.html#afcd1cfa04037980c000c94c826517759">More...</a><br /></td></tr>
<tr class="separator:afcd1cfa04037980c000c94c826517759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7c31783f9f455b20c35d43f46ee03d8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#ad7c31783f9f455b20c35d43f46ee03d8">select_sector</a> (struct <a class="el" href="structata__disk.html">ata_disk</a> *d, <a class="el" href="block_8h.html#a5817ce5926a42095888c9518172ec905">block_sector_t</a> sec_no)</td></tr>
<tr class="memdesc:ad7c31783f9f455b20c35d43f46ee03d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Selects device D, waiting for it to become ready, and then writes SEC_NO to the disk's sector selection registers.  <a href="ide_8c.html#ad7c31783f9f455b20c35d43f46ee03d8">More...</a><br /></td></tr>
<tr class="separator:ad7c31783f9f455b20c35d43f46ee03d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdfc60cf49c8edf42ed8d25b0d2b6314"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#acdfc60cf49c8edf42ed8d25b0d2b6314">issue_pio_command</a> (struct <a class="el" href="structchannel.html">channel</a> *c, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> command)</td></tr>
<tr class="memdesc:acdfc60cf49c8edf42ed8d25b0d2b6314"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes COMMAND to channel C and prepares for receiving a completion interrupt.  <a href="ide_8c.html#acdfc60cf49c8edf42ed8d25b0d2b6314">More...</a><br /></td></tr>
<tr class="separator:acdfc60cf49c8edf42ed8d25b0d2b6314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e24dabc72eca487989a0d9b6fe1347"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#ad6e24dabc72eca487989a0d9b6fe1347">input_sector</a> (struct <a class="el" href="structchannel.html">channel</a> *c, void *sector)</td></tr>
<tr class="memdesc:ad6e24dabc72eca487989a0d9b6fe1347"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a sector from channel C's data register in PIO mode into SECTOR, which must have room for BLOCK_SECTOR_SIZE bytes.  <a href="ide_8c.html#ad6e24dabc72eca487989a0d9b6fe1347">More...</a><br /></td></tr>
<tr class="separator:ad6e24dabc72eca487989a0d9b6fe1347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a825fd294c52f5c4983939b1d84607a61"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a825fd294c52f5c4983939b1d84607a61">output_sector</a> (struct <a class="el" href="structchannel.html">channel</a> *c, const void *sector)</td></tr>
<tr class="memdesc:a825fd294c52f5c4983939b1d84607a61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes SECTOR to channel C's data register in PIO mode.  <a href="ide_8c.html#a825fd294c52f5c4983939b1d84607a61">More...</a><br /></td></tr>
<tr class="separator:a825fd294c52f5c4983939b1d84607a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac51161a8c0b58de728cb08a3ff722b0f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#ac51161a8c0b58de728cb08a3ff722b0f">wait_until_idle</a> (const struct <a class="el" href="structata__disk.html">ata_disk</a> *d)</td></tr>
<tr class="memdesc:ac51161a8c0b58de728cb08a3ff722b0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Low-level ATA primitives.  <a href="ide_8c.html#ac51161a8c0b58de728cb08a3ff722b0f">More...</a><br /></td></tr>
<tr class="separator:ac51161a8c0b58de728cb08a3ff722b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32d318073c2235e9b03bd77ed17ae580"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a32d318073c2235e9b03bd77ed17ae580">wait_while_busy</a> (const struct <a class="el" href="structata__disk.html">ata_disk</a> *d)</td></tr>
<tr class="memdesc:a32d318073c2235e9b03bd77ed17ae580"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait up to 30 seconds for disk D to clear BSY, and then return the status of the DRQ bit.  <a href="ide_8c.html#a32d318073c2235e9b03bd77ed17ae580">More...</a><br /></td></tr>
<tr class="separator:a32d318073c2235e9b03bd77ed17ae580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7252ab4c28b6aed431703ba2b124e05e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e">select_device</a> (const struct <a class="el" href="structata__disk.html">ata_disk</a> *d)</td></tr>
<tr class="memdesc:a7252ab4c28b6aed431703ba2b124e05e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program D's channel so that D is now the selected disk.  <a href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e">More...</a><br /></td></tr>
<tr class="separator:a7252ab4c28b6aed431703ba2b124e05e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8393ec752f120abb30d97b14a69600"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a5d8393ec752f120abb30d97b14a69600">select_device_wait</a> (const struct <a class="el" href="structata__disk.html">ata_disk</a> *d)</td></tr>
<tr class="memdesc:a5d8393ec752f120abb30d97b14a69600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select disk D in its channel, as <a class="el" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e" title="Program D&#39;s channel so that D is now the selected disk.">select_device()</a>, but wait for the channel to become idle before and after.  <a href="ide_8c.html#a5d8393ec752f120abb30d97b14a69600">More...</a><br /></td></tr>
<tr class="separator:a5d8393ec752f120abb30d97b14a69600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968e89e258918c93a81618744b6c0e35"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a968e89e258918c93a81618744b6c0e35">interrupt_handler</a> (struct <a class="el" href="structintr__frame.html">intr_frame</a> *f)</td></tr>
<tr class="memdesc:a968e89e258918c93a81618744b6c0e35"><td class="mdescLeft">&#160;</td><td class="mdescRight">ATA interrupt handler.  <a href="ide_8c.html#a968e89e258918c93a81618744b6c0e35">More...</a><br /></td></tr>
<tr class="separator:a968e89e258918c93a81618744b6c0e35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e8e1409e0675bdd93040403c52dd660"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660">ide_init</a> (void)</td></tr>
<tr class="memdesc:a5e8e1409e0675bdd93040403c52dd660"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the disk subsystem and detect disks.  <a href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660">More...</a><br /></td></tr>
<tr class="separator:a5e8e1409e0675bdd93040403c52dd660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a992ae2a2f8f5e9dbaa54b2200a5e44"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a6a992ae2a2f8f5e9dbaa54b2200a5e44">descramble_ata_string</a> (char *, int size)</td></tr>
<tr class="memdesc:a6a992ae2a2f8f5e9dbaa54b2200a5e44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disk detection and identification.  <a href="ide_8c.html#a6a992ae2a2f8f5e9dbaa54b2200a5e44">More...</a><br /></td></tr>
<tr class="separator:a6a992ae2a2f8f5e9dbaa54b2200a5e44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc9cbaf0892e023867624dca21f5bfa2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2">ide_read</a> (void *d_, <a class="el" href="block_8h.html#a5817ce5926a42095888c9518172ec905">block_sector_t</a> sec_no, void *<a class="el" href="input_8c.html#a02352b0fa3692f7c9029b2e12edcdbb6">buffer</a>)</td></tr>
<tr class="memdesc:afc9cbaf0892e023867624dca21f5bfa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes.  <a href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2">More...</a><br /></td></tr>
<tr class="separator:afc9cbaf0892e023867624dca21f5bfa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968318bffbdf3ecb701360fc0ed9cf49"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49">ide_write</a> (void *d_, <a class="el" href="block_8h.html#a5817ce5926a42095888c9518172ec905">block_sector_t</a> sec_no, const void *<a class="el" href="input_8c.html#a02352b0fa3692f7c9029b2e12edcdbb6">buffer</a>)</td></tr>
<tr class="memdesc:a968318bffbdf3ecb701360fc0ed9cf49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes.  <a href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49">More...</a><br /></td></tr>
<tr class="separator:a968318bffbdf3ecb701360fc0ed9cf49"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae81c6d1c941d4f5fac5cfd5c2a26283c"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structchannel.html">channel</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#ae81c6d1c941d4f5fac5cfd5c2a26283c">channels</a> [<a class="el" href="ide_8c.html#aed31f8d4617249f3a96e6038e652194e">CHANNEL_CNT</a>]</td></tr>
<tr class="separator:ae81c6d1c941d4f5fac5cfd5c2a26283c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a023601e9a8f1fc769aa9d2243f10ed95"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structblock__operations.html">block_operations</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ide_8c.html#a023601e9a8f1fc769aa9d2243f10ed95">ide_operations</a></td></tr>
<tr class="separator:a023601e9a8f1fc769aa9d2243f10ed95"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aed31f8d4617249f3a96e6038e652194e" name="aed31f8d4617249f3a96e6038e652194e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed31f8d4617249f3a96e6038e652194e">&#9670;&nbsp;</a></span>CHANNEL_CNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHANNEL_CNT&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We support the two "legacy" ATA channels found in a standard PC. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00079">79</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a34785bd459d404747354fc4c5da3eeb2" name="a34785bd459d404747354fc4c5da3eeb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34785bd459d404747354fc4c5da3eeb2">&#9670;&nbsp;</a></span>CMD_IDENTIFY_DEVICE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_IDENTIFY_DEVICE&#160;&#160;&#160;0xec</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Commands. </p>
<p >Many more are defined but this is the small subset that we use. IDENTIFY DEVICE. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00049">49</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="ac3249b993cd9bee1a522ab7fe4fa2875" name="ac3249b993cd9bee1a522ab7fe4fa2875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3249b993cd9bee1a522ab7fe4fa2875">&#9670;&nbsp;</a></span>CMD_READ_SECTOR_RETRY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_READ_SECTOR_RETRY&#160;&#160;&#160;0x20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>READ SECTOR with retries. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00050">50</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="ab693c8ade8ea06207282a120c6a95b49" name="ab693c8ade8ea06207282a120c6a95b49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab693c8ade8ea06207282a120c6a95b49">&#9670;&nbsp;</a></span>CMD_WRITE_SECTOR_RETRY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_WRITE_SECTOR_RETRY&#160;&#160;&#160;0x30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WRITE SECTOR with retries. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00051">51</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a20d55587e2b43fed1168972dcc963728" name="a20d55587e2b43fed1168972dcc963728"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20d55587e2b43fed1168972dcc963728">&#9670;&nbsp;</a></span>CTL_SRST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CTL_SRST&#160;&#160;&#160;0x04</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Control Register bits. </p>
<p >Software Reset. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00039">39</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a229d9c672119c31246cb5a46955252d0" name="a229d9c672119c31246cb5a46955252d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a229d9c672119c31246cb5a46955252d0">&#9670;&nbsp;</a></span>DEV_DEV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEV_DEV&#160;&#160;&#160;0x10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select device: 0=master, 1=slave. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00044">44</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a3a8db654ddff6915da10cc09d0e14771" name="a3a8db654ddff6915da10cc09d0e14771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a8db654ddff6915da10cc09d0e14771">&#9670;&nbsp;</a></span>DEV_LBA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEV_LBA&#160;&#160;&#160;0x40</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Linear based addressing. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00043">43</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a980214a3ca249c5c0956b189e47a56f2" name="a980214a3ca249c5c0956b189e47a56f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a980214a3ca249c5c0956b189e47a56f2">&#9670;&nbsp;</a></span>DEV_MBS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEV_MBS&#160;&#160;&#160;0xa0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Device Register bits. </p>
<p >Must be set. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00042">42</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a87589b087951334b384d285e1bf486c9" name="a87589b087951334b384d285e1bf486c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87589b087951334b384d285e1bf486c9">&#9670;&nbsp;</a></span>reg_alt_status</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_alt_status</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="ide_8c.html#a0a34473ff78753fa67a09fc8f34f3b81">reg_ctl</a> (CHANNEL)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alt Status (r/o). </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00031">31</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="ab99d71cce46b6e27fe03ca023d48056c" name="ab99d71cce46b6e27fe03ca023d48056c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab99d71cce46b6e27fe03ca023d48056c">&#9670;&nbsp;</a></span>reg_command</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_command</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="ide_8c.html#a77237dcfa9c18241804aeb5f1a75d030">reg_status</a> (CHANNEL)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Command (w/o). </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00025">25</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a0a34473ff78753fa67a09fc8f34f3b81" name="a0a34473ff78753fa67a09fc8f34f3b81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a34473ff78753fa67a09fc8f34f3b81">&#9670;&nbsp;</a></span>reg_ctl</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_ctl</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 0x206)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ATA control block port addresses. </p>
<p >(If we supported non-legacy ATA controllers this would not be flexible enough, but it's fine for what we do.) Control (w/o). </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00030">30</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a4063badbb8a8ae2e44ae6d2099b5f0d3" name="a4063badbb8a8ae2e44ae6d2099b5f0d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4063badbb8a8ae2e44ae6d2099b5f0d3">&#9670;&nbsp;</a></span>reg_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_data</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The code in this file is an interface to an ATA (IDE) controller. </p>
<p >It attempts to comply to [ATA-3]. ATA command block port addresses. Data. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00017">17</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a1bd78e11470d9a7ffb6d720c9c3801b6" name="a1bd78e11470d9a7ffb6d720c9c3801b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bd78e11470d9a7ffb6d720c9c3801b6">&#9670;&nbsp;</a></span>reg_device</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_device</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 6)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Device/LBA 27:24. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00023">23</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="ab4452e5ae677c19dae7868616be5b25a" name="ab4452e5ae677c19dae7868616be5b25a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4452e5ae677c19dae7868616be5b25a">&#9670;&nbsp;</a></span>reg_error</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_error</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00018">18</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a5bb66f5a8375377794d9895bf5f54b8f" name="a5bb66f5a8375377794d9895bf5f54b8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bb66f5a8375377794d9895bf5f54b8f">&#9670;&nbsp;</a></span>reg_lbah</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_lbah</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 5)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LBA 23:16. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00022">22</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a4779eaf99f72f15a3de118f1b32ffd2d" name="a4779eaf99f72f15a3de118f1b32ffd2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4779eaf99f72f15a3de118f1b32ffd2d">&#9670;&nbsp;</a></span>reg_lbal</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_lbal</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 3)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LBA 0:7. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00020">20</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="af48b9ab28b218aaf86755ced4db35aa1" name="af48b9ab28b218aaf86755ced4db35aa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af48b9ab28b218aaf86755ced4db35aa1">&#9670;&nbsp;</a></span>reg_lbam</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_lbam</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 4)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LBA 15:8. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00021">21</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a5552d25f2cceca35f1390ec81072263c" name="a5552d25f2cceca35f1390ec81072263c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5552d25f2cceca35f1390ec81072263c">&#9670;&nbsp;</a></span>reg_nsect</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_nsect</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sector Count. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00019">19</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a77237dcfa9c18241804aeb5f1a75d030" name="a77237dcfa9c18241804aeb5f1a75d030"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77237dcfa9c18241804aeb5f1a75d030">&#9670;&nbsp;</a></span>reg_status</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define reg_status</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">CHANNEL</td><td>)</td>
          <td>&#160;&#160;&#160;((CHANNEL)-&gt;reg_base + 7)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Status (r/o). </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00024">24</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a9d568d02d45d914c5839758673f0ece0" name="a9d568d02d45d914c5839758673f0ece0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d568d02d45d914c5839758673f0ece0">&#9670;&nbsp;</a></span>STA_BSY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STA_BSY&#160;&#160;&#160;0x80</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alternate Status Register bits. </p>
<p >Busy. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00034">34</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a8b14630ab1ade3cf9a53d8876f7288db" name="a8b14630ab1ade3cf9a53d8876f7288db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b14630ab1ade3cf9a53d8876f7288db">&#9670;&nbsp;</a></span>STA_DRDY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STA_DRDY&#160;&#160;&#160;0x40</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Device Ready. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00035">35</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<a id="a92e968805f523a6eecdec3b1fe6ccbab" name="a92e968805f523a6eecdec3b1fe6ccbab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92e968805f523a6eecdec3b1fe6ccbab">&#9670;&nbsp;</a></span>STA_DRQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STA_DRQ&#160;&#160;&#160;0x08</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Data Request. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00036">36</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="afb1b543e585d7b5757bf9406b8705349" name="afb1b543e585d7b5757bf9406b8705349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb1b543e585d7b5757bf9406b8705349">&#9670;&nbsp;</a></span>check_device_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> check_device_type </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structata__disk.html">ata_disk</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks whether device D is an ATA disk and sets D's is_ata member appropriately. </p>
<p >If D is device 0 (master), returns true if it's possible that a slave (device 1) exists on this channel. If D is device 1 (slave), the return value is not meaningful. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00230">230</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="ide_8c_source.html#l00057">ata_disk::channel</a>, <a class="el" href="ide_8c_source.html#l00058">ata_disk::dev_no</a>, <a class="el" href="io_8h_source.html#l00009">inb()</a>, <a class="el" href="ide_8c_source.html#l00059">ata_disk::is_ata</a>, <a class="el" href="ide_8c_source.html#l00018">reg_error</a>, <a class="el" href="ide_8c_source.html#l00022">reg_lbah</a>, <a class="el" href="ide_8c_source.html#l00021">reg_lbam</a>, <a class="el" href="ide_8c_source.html#l00024">reg_status</a>, <a class="el" href="ide_8c_source.html#l00484">select_device()</a>, <a class="el" href="ide_8c_source.html#l00034">STA_BSY</a>, and <a class="el" href="ide_8c_source.html#l00035">STA_DRDY</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00102">ide_init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_afb1b543e585d7b5757bf9406b8705349_cgraph.png" border="0" usemap="#aide_8c_afb1b543e585d7b5757bf9406b8705349_cgraph" alt=""/></div>
<map name="aide_8c_afb1b543e585d7b5757bf9406b8705349_cgraph" id="aide_8c_afb1b543e585d7b5757bf9406b8705349_cgraph">
<area shape="rect" title="Checks whether device D is an ATA disk and sets D&#39;s is_ata member appropriately." alt="" coords="5,1145,141,1171"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="369,1119,409,1146"/>
<area shape="rect" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e" title="Program D&#39;s channel so that D is now the selected disk." alt="" coords="189,1170,292,1197"/>
<area shape="rect" href="io_8h.html#a903c588b94e0e8386c8a6f8caa4a5a72" title="Writes byte DATA to PORT." alt="" coords="365,1221,413,1247"/>
<area shape="rect" href="timer_8c.html#a5d4df9c9580a97f5eee2e70ae8ad43a0" title="Sleeps for approximately NS nanoseconds." alt="" coords="340,1170,439,1197"/>
<area shape="rect" href="timer_8c.html#a9bd10eb80561359273e022f4c80b483f" title="Sleep for approximately NUM/DENOM seconds." alt="" coords="487,1170,603,1197"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1463,993,1565,1019"/>
<area shape="rect" href="timer_8c.html#a28553fa387ff127de26e330dfcfe9fa1" title="Busy&#45;wait for approximately NUM/DENOM seconds." alt="" coords="651,1221,767,1247"/>
<area shape="rect" href="timer_8c.html#aa24fbc19fb550d9efd5cabd97489a399" title="Sleeps for approximately TICKS timer ticks." alt="" coords="663,1069,754,1095"/>
<area shape="rect" href="timer_8c.html#a804190f8e66f39ac2ddb5891de3eec73" title="Iterates through a simple loop LOOPS times, for implementing brief delays." alt="" coords="827,1221,908,1247"/>
<area shape="rect" href="thread_8c.html#aaa9229e0f462f60bb9550919fa3d7699" title="Yields the CPU." alt="" coords="968,917,1063,943"/>
<area shape="rect" href="timer_8c.html#a58f1f79abf9bc0515a305ba89c58b9fa" title="Returns the number of timer ticks elapsed since THEN, which should be a value once returned by timer_..." alt="" coords="815,1069,920,1095"/>
<area shape="rect" href="timer_8c.html#a2b50be77101b38176d21b52cc425cf3e" title="Returns the number of timer ticks since the OS booted." alt="" coords="973,1043,1058,1070"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1469,929,1559,955"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1286,1018,1377,1045"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="1111,967,1211,994"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1459,30,1569,57"/>
<area shape="rect" href="thread_8c.html#a63e3ec45b7bf0028e55f2b9ab1603306" title="Schedules a new process." alt="" coords="1123,739,1199,766"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1827,562,1937,589"/>
<area shape="rect" href="interrupt_8c.html#a5a896b58d69d8d5ffa7b738c31b924d1" title="Enables interrupts and returns the previous interrupt status." alt="" coords="1287,967,1375,994"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a4ed47fea6462c7db4fde2d0a30e9ce26" title="Returns LIST&#39;s tail." alt="" coords="2025,30,2093,57"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a57866ab170795aa4191fa14fa1c39dd3" title="Inserts ELEM just before BEFORE, which may be either an interior element or a tail." alt="" coords="1655,30,1733,57"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#ae2dec7db343c61370bd42b559ecf80bd" title="Returns true if ELEM is an interior element, false otherwise." alt="" coords="1842,81,1922,107"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#afd128d25023ae454774ad1754af3ee74" title="Returns true if ELEM is a tail, false otherwise." alt="" coords="1854,30,1910,57"/>
<area shape="rect" href="thread_8c.html#a85274904406e17925db793a7603f9c49" title="Initializes the threading system by transforming the code that&#39;s currently running into a thread." alt="" coords="2021,511,2098,538"/>
<area shape="rect" href="intq_8c.html#ac473f50d2829cba1321d34a57c425042" title="Returns the position after POS within an intq." alt="" coords="1308,815,1355,842"/>
<area shape="rect" href="thread_8c.html#ace7a46dcf0f5c9c4cbb8f47a5b3c76f5" title="Chooses and returns the next thread to be scheduled." alt="" coords="1263,182,1400,209"/>
<area shape="rect" href="thread_8c.html#a42e628208d70ba10d79c26d902b60650" title="Returns the running thread." alt="" coords="2003,714,2115,741"/>
<area shape="rect" href="switch_8h.html#a72fbed245d8de7e36d70eb4682682c98" title="Switches from CUR, which must be the running thread, to NEXT, which must also be running switch_threa..." alt="" coords="1276,765,1387,791"/>
<area shape="rect" href="thread_8c.html#acbbd25908c41e62d44a179cfbc3962e2" title="Completes a thread switch by activating the new thread&#39;s page tables, and, if the previous thread is ..." alt="" coords="1259,663,1404,690"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a5591fb615fa4861afb657609792b0777" title="Returns true if LIST is empty, false otherwise." alt="" coords="1841,131,1923,158"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a25d199933dd83abc9cecfe452bf39837" title="Removes the front element from LIST and returns it." alt="" coords="1463,131,1565,158"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a08c9ed5b4d04c46b943f09f84c93064d" title="Returns the beginning of LIST." alt="" coords="2020,131,2099,158"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a3e89b017d033355801dafd955caa8ad0" title="Returns the front element in LIST." alt="" coords="1658,131,1730,158"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a20dc7b49b9631d32e71294ea9cf38e78" title="Removes ELEM from its list and returns the element that followed it." alt="" coords="1649,81,1739,107"/>
<area shape="rect" href="vaddr_8h.html#a42d21e08e54a8ca6c174c731df74fd3e" title="Round down to nearest page boundary." alt="" coords="2167,714,2284,741"/>
<area shape="rect" href="palloc_8c.html#ad3fe56f7c611216596e7565fb8521409" title="Frees the page at PAGE." alt="" coords="1452,613,1576,639"/>
<area shape="rect" href="process_8c.html#a23823b283ef2815ecc5ae19e772dac24" title="Sets up the CPU for running user code in the current thread." alt="" coords="1453,663,1575,690"/>
<area shape="rect" href="palloc_8c.html#af4c2af0e0bdc81d1ea21354c4234b20e" title="Frees the PAGE_CNT pages starting at PAGES." alt="" coords="1624,334,1764,361"/>
<area shape="rect" href="bitmap_8c.html#ab8910020ce78e389457c0607990d04d3" title="Returns true if every bit in B between START and START + CNT, exclusive, is set to true,..." alt="" coords="1841,283,1923,310"/>
<area shape="rect" href="bitmap_8c.html#a7b2eaaf4ee3c0f7794b4e5293f3b9760" title="Sets the CNT bits starting at START in B to VALUE." alt="" coords="1812,334,1952,361"/>
<area shape="rect" href="string_8c.html#a32f4138a368f78ed6d4339e679641261" title="Sets the SIZE bytes in DST to VALUE." alt="" coords="1847,435,1917,462"/>
<area shape="rect" href="palloc_8c.html#a2adf802e51d008838946d621cb4e8fb2" title="Returns true if PAGE was allocated from POOL, false otherwise." alt="" coords="1823,182,1941,209"/>
<area shape="rect" href="vaddr_8h.html#a1efae7b168a7e2234c0e4022d889bdc8" title="Virtual page number." alt="" coords="2030,207,2089,234"/>
<area shape="rect" href="vaddr_8h.html#ac12acb882dfd1a70e6c8f69935dc3747" title="Offset within a page." alt="" coords="1851,385,1913,411"/>
<area shape="rect" href="bitmap_8c.html#a90f5f9e5e7afbd943d0c6c33fc0d8557" title="Returns true if any bits in B between START and START + CNT, exclusive, are set to VALUE,..." alt="" coords="2000,283,2119,310"/>
<area shape="rect" href="bitmap_8c.html#a766a7941acc1371fb82ed4f70a1ecf37" title="Setting and testing single bits." alt="" coords="2016,334,2103,361"/>
<area shape="rect" href="pagedir_8c.html#ac0a75950cc56724fef94d224df4b0cd0" title="Loads page directory PD into the CPU&#39;s page directory base register." alt="" coords="1634,663,1754,690"/>
<area shape="rect" href="tss_8c.html#a089f0d1278964a0cc36f92d47febd2d4" title="Sets the ring 0 stack pointer in the TSS to point to the end of the thread stack." alt="" coords="1651,613,1737,639"/>
<area shape="rect" href="vaddr_8h.html#a0f6ff2f4a18892d83d6e1c1a3c2d9f9b" title="Returns physical address at which kernel virtual address VADDR is mapped." alt="" coords="1859,663,1905,690"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_afb1b543e585d7b5757bf9406b8705349_icgraph.png" border="0" usemap="#aide_8c_afb1b543e585d7b5757bf9406b8705349_icgraph" alt=""/></div>
<map name="aide_8c_afb1b543e585d7b5757bf9406b8705349_icgraph" id="aide_8c_afb1b543e585d7b5757bf9406b8705349_icgraph">
<area shape="rect" title="Checks whether device D is an ATA disk and sets D&#39;s is_ata member appropriately." alt="" coords="248,5,384,32"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="136,5,200,32"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,5,88,32"/>
</map>
</div>

</div>
</div>
<a id="a6a992ae2a2f8f5e9dbaa54b2200a5e44" name="a6a992ae2a2f8f5e9dbaa54b2200a5e44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a992ae2a2f8f5e9dbaa54b2200a5e44">&#9670;&nbsp;</a></span>descramble_ata_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char * descramble_ata_string </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Disk detection and identification. </p>
<p >Translates STRING, which consists of SIZE bytes in a funky format, into a null-terminated string in-place.</p>
<p >Drops trailing whitespace and null bytes. Returns STRING. <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00316">316</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="ctype_8h_source.html#l00012">isspace()</a>, and <a class="el" href="block_8c_source.html#l00015">block::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00260">identify_ata_device()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a6a992ae2a2f8f5e9dbaa54b2200a5e44_cgraph.png" border="0" usemap="#aide_8c_a6a992ae2a2f8f5e9dbaa54b2200a5e44_cgraph" alt=""/></div>
<map name="aide_8c_a6a992ae2a2f8f5e9dbaa54b2200a5e44_cgraph" id="aide_8c_a6a992ae2a2f8f5e9dbaa54b2200a5e44_cgraph">
<area shape="rect" title="Disk detection and identification." alt="" coords="5,5,163,32"/>
<area shape="rect" href="ctype_8h.html#a9318513eb3136e55002d65bf602f74a7" title=" " alt="" coords="211,5,277,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a6a992ae2a2f8f5e9dbaa54b2200a5e44_icgraph.png" border="0" usemap="#aide_8c_a6a992ae2a2f8f5e9dbaa54b2200a5e44_icgraph" alt=""/></div>
<map name="aide_8c_a6a992ae2a2f8f5e9dbaa54b2200a5e44_icgraph" id="aide_8c_a6a992ae2a2f8f5e9dbaa54b2200a5e44_icgraph">
<area shape="rect" title="Disk detection and identification." alt="" coords="432,5,589,32"/>
<area shape="rect" href="ide_8c.html#afcd1cfa04037980c000c94c826517759" title="Sends an IDENTIFY DEVICE command to disk D and reads the response." alt="" coords="248,5,384,32"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="136,5,200,32"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,5,88,32"/>
</map>
</div>

</div>
</div>
<a id="a5e8e1409e0675bdd93040403c52dd660" name="a5e8e1409e0675bdd93040403c52dd660"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e8e1409e0675bdd93040403c52dd660">&#9670;&nbsp;</a></span>ide_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ide_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the disk subsystem and detect disks. </p>
<p ><a class="el" href="ide_8h.html">devices/ide.h</a> </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00102">102</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="ide_8c_source.html#l00057">ata_disk::channel</a>, <a class="el" href="ide_8c_source.html#l00079">CHANNEL_CNT</a>, <a class="el" href="ide_8c_source.html#l00080">channels</a>, <a class="el" href="ide_8c_source.html#l00230">check_device_type()</a>, <a class="el" href="ide_8c_source.html#l00073">channel::completion_wait</a>, <a class="el" href="ide_8c_source.html#l00058">ata_disk::dev_no</a>, <a class="el" href="ide_8c_source.html#l00075">channel::devices</a>, <a class="el" href="ide_8c_source.html#l00071">channel::expecting_interrupt</a>, <a class="el" href="ide_8c_source.html#l00260">identify_ata_device()</a>, <a class="el" href="ide_8c_source.html#l00507">interrupt_handler()</a>, <a class="el" href="interrupt_8c_source.html#l00181">intr_register_ext()</a>, <a class="el" href="ide_8c_source.html#l00068">channel::irq</a>, <a class="el" href="ide_8c_source.html#l00059">ata_disk::is_ata</a>, <a class="el" href="ide_8c_source.html#l00070">channel::lock</a>, <a class="el" href="synch_8c_source.html#l00176">lock_init()</a>, <a class="el" href="ide_8c_source.html#l00056">ata_disk::name</a>, <a class="el" href="ide_8c_source.html#l00066">channel::name</a>, <a class="el" href="debug_8h_source.html#l00035">NOT_REACHED</a>, <a class="el" href="ide_8c_source.html#l00067">channel::reg_base</a>, <a class="el" href="ide_8c_source.html#l00165">reset_channel()</a>, <a class="el" href="synch_8c_source.html#l00045">sema_init()</a>, and <a class="el" href="lib_2stdio_8c_source.html#l00062">snprintf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l00073">pintos_init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a5e8e1409e0675bdd93040403c52dd660_cgraph.png" border="0" usemap="#aide_8c_a5e8e1409e0675bdd93040403c52dd660_cgraph" alt=""/></div>
<map name="aide_8c_a5e8e1409e0675bdd93040403c52dd660_cgraph" id="aide_8c_a5e8e1409e0675bdd93040403c52dd660_cgraph">
<area shape="rect" title="Initialize the disk subsystem and detect disks." alt="" coords="5,903,69,929"/>
<area shape="rect" href="ide_8c.html#afb1b543e585d7b5757bf9406b8705349" title="Checks whether device D is an ATA disk and sets D&#39;s is_ata member appropriately." alt="" coords="312,107,448,133"/>
<area shape="rect" href="ide_8c.html#afcd1cfa04037980c000c94c826517759" title="Sends an IDENTIFY DEVICE command to disk D and reads the response." alt="" coords="117,865,253,892"/>
<area shape="rect" href="lib_2stdio_8c.html#a913035b9a30cd1b34c5e587dfbf26f92" title="Like printf(), except that output is stored into BUFFER, which must have space for BUF_SIZE character..." alt="" coords="347,1245,413,1272"/>
<area shape="rect" href="ide_8c.html#a968e89e258918c93a81618744b6c0e35" title="ATA interrupt handler." alt="" coords="319,461,441,488"/>
<area shape="rect" href="interrupt_8c.html#a38cd217e72ddb3f58db591a061c99691" title="Registers external interrupt VEC_NO to invoke HANDLER, which is named NAME for debugging purposes." alt="" coords="127,1004,244,1031"/>
<area shape="rect" href="synch_8c.html#aa760472aa4916bba476b2165ea25b411" title="Initializes LOCK." alt="" coords="150,1257,221,1284"/>
<area shape="rect" href="synch_8c.html#a1349a31f4880cf4eae026761f0ab3343" title="This file is derived from source code for the Nachos instructional operating system." alt="" coords="341,1347,419,1373"/>
<area shape="rect" href="ide_8c.html#a03eb0d9954faefcc1634f76a286f78f5" title="Resets an ATA channel and waits for any devices present on it to finish the reset." alt="" coords="327,309,433,336"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="778,183,818,209"/>
<area shape="rect" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e" title="Program D&#39;s channel so that D is now the selected disk." alt="" coords="549,5,651,32"/>
<area shape="rect" href="io_8h.html#a903c588b94e0e8386c8a6f8caa4a5a72" title="Writes byte DATA to PORT." alt="" coords="774,56,822,83"/>
<area shape="rect" href="timer_8c.html#a5d4df9c9580a97f5eee2e70ae8ad43a0" title="Sleeps for approximately NS nanoseconds." alt="" coords="749,5,847,32"/>
<area shape="rect" href="timer_8c.html#a9bd10eb80561359273e022f4c80b483f" title="Sleep for approximately NUM/DENOM seconds." alt="" coords="903,323,1019,349"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1224,487,1325,513"/>
<area shape="rect" href="block_8c.html#a39d3d6f31410885d66cf8f719339d79d" title="Registers a new block device with the given NAME." alt="" coords="327,916,433,943"/>
<area shape="rect" href="lib_2stdio_8c.html#a225f673cc2251206f9da043c5a55a80b" title="Prints SIZE, which represents a number of bytes, in a human&#45;readable format, e.g." alt="" coords="507,664,693,691"/>
<area shape="rect" href="lib_2stdio_8c.html#a98631211a4a8aee62f572375d5b637be" title="Writes formatted output to the console." alt="" coords="772,715,824,741"/>
<area shape="rect" href="ide_8c.html#a6a992ae2a2f8f5e9dbaa54b2200a5e44" title="Disk detection and identification." alt="" coords="301,1195,459,1221"/>
<area shape="rect" href="ide_8c.html#ad6e24dabc72eca487989a0d9b6fe1347" title="Reads a sector from channel C&#39;s data register in PIO mode into SECTOR, which must have room for BLOCK..." alt="" coords="333,1144,427,1171"/>
<area shape="rect" href="ide_8c.html#acdfc60cf49c8edf42ed8d25b0d2b6314" title="Writes COMMAND to channel C and prepares for receiving a completion interrupt." alt="" coords="528,411,672,437"/>
<area shape="rect" href="partition_8c.html#ae1af155dafc1e46f1725d8061189421a" title="Scans BLOCK for partitions of interest to Pintos." alt="" coords="327,852,433,879"/>
<area shape="rect" href="ide_8c.html#a5d8393ec752f120abb30d97b14a69600" title="Select disk D in its channel, as select_device(), but wait for the channel to become idle before and ..." alt="" coords="313,259,447,285"/>
<area shape="rect" href="synch_8c.html#ae10ded72d3b93a832b7107566f09286c" title="Down or &quot;P&quot; operation on a semaphore." alt="" coords="751,1091,845,1117"/>
<area shape="rect" href="ide_8c.html#a32d318073c2235e9b03bd77ed17ae580" title="Wait up to 30 seconds for disk D to clear BSY, and then return the status of the DRQ bit." alt="" coords="541,461,659,488"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="905,897,1016,924"/>
<area shape="rect" href="malloc_8c.html#a9c36d0fe3ec4675cbffdc9b52f5fb399" title="Obtains and returns a new block of at least SIZE bytes." alt="" coords="768,891,828,917"/>
<area shape="rect" href="string_8c.html#a4637af6f79bac4043e1064f0837d0ddc" title="Copies string SRC to DST." alt="" coords="570,941,630,968"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a5591fb615fa4861afb657609792b0777" title="Returns true if LIST is empty, false otherwise." alt="" coords="919,512,1002,539"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a25d199933dd83abc9cecfe452bf39837" title="Removes the front element from LIST and returns it." alt="" coords="909,664,1012,691"/>
<area shape="rect" href="kernel_2console_8c.html#aae4ab8b56862ed0a04505cafb8a05112" title="The standard vprintf() function, which is like printf() but uses a va_list." alt="" coords="931,715,990,741"/>
<area shape="rect" href="ctype_8h.html#a9318513eb3136e55002d65bf602f74a7" title=" " alt="" coords="567,1195,633,1221"/>
<area shape="rect" href="io_8h.html#a796ec08686cf1380808556b31cabc730" title="Reads CNT 16&#45;bit (halfword) units from PORT, one after another, and stores them into the buffer start..." alt="" coords="575,1144,625,1171"/>
<area shape="rect" href="block_8c.html#abfb4cd8ff36ddbdf93ebc1944ccfbd4d" title="Returns BLOCK&#39;s name (e.g." alt="" coords="751,840,845,867"/>
<area shape="rect" href="partition_8c.html#a5723d235ee99ff5ebd79a4db49236237" title="Reads the partition table in the given SECTOR of BLOCK and scans it for partitions of interest to Pin..." alt="" coords="530,840,670,867"/>
<area shape="rect" href="ide_8c.html#ac51161a8c0b58de728cb08a3ff722b0f" title="Low&#45;level ATA primitives." alt="" coords="547,259,653,285"/>
<area shape="rect" href="timer_8c.html#ac386900a4e0ba0d6f338b8c5534776d1" title="Sleeps for approximately US microseconds." alt="" coords="749,309,847,336"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1076,1137,1167,1164"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1076,563,1167,589"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="911,613,1011,640"/>
<area shape="rect" href="thread_8c.html#ad70c4eeb51cd5b0ce2abb939924c7469" title="Puts the current thread to sleep." alt="" coords="911,1087,1010,1113"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1067,1036,1176,1063"/>
<area shape="rect" href="lib_2stdio_8c.html#a1286c6b071007938f54e9b859109f89d" title="Like vprintf(), except that output is stored into BUFFER, which must have space for BUF_SIZE characte..." alt="" coords="564,1245,636,1272"/>
<area shape="rect" href="timer_8c.html#a10cbeaa00e0ceb825ddd7a44724881c6" title="Sleeps for approximately MS milliseconds." alt="" coords="747,360,849,387"/>
<area shape="rect" href="synch_8c.html#a6da4176e1c419bd4467b181c66b077da" title="Up or &quot;V&quot; operation on a semaphore." alt="" coords="561,512,639,539"/>
<area shape="rect" href="thread_8c.html#a0cd30c260607aec4597c5b613c5e013f" title="Transitions a blocked thread T to the ready&#45;to&#45;run state." alt="" coords="741,563,855,589"/>
<area shape="rect" href="interrupt_8c.html#a7e7d2edfe1ec7f51b54704080de2f4ca" title="Registers interrupt VEC_NO to invoke HANDLER with descriptor privilege level DPL." alt="" coords="321,1296,439,1323"/>
<area shape="rect" href="interrupt_8c.html#a75ac431d18ce7aff146bef22379c1dcd" title="Interrupt Descriptor Table helpers." alt="" coords="543,1296,657,1323"/>
<area shape="rect" href="interrupt_8c.html#a79e99b0236c49a7a12d52a2ec74fefa5" title="Creates a trap gate that invokes FUNCTION with the given DPL." alt="" coords="541,1347,659,1373"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a8aa862d10f52f7b0348fce990c7c12db" title="Initializes LIST as an empty list." alt="" coords="569,1397,631,1424"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a5e8e1409e0675bdd93040403c52dd660_icgraph.png" border="0" usemap="#aide_8c_a5e8e1409e0675bdd93040403c52dd660_icgraph" alt=""/></div>
<map name="aide_8c_a5e8e1409e0675bdd93040403c52dd660_icgraph" id="aide_8c_a5e8e1409e0675bdd93040403c52dd660_icgraph">
<area shape="rect" title="Initialize the disk subsystem and detect disks." alt="" coords="136,5,200,32"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,5,88,32"/>
</map>
</div>

</div>
</div>
<a id="afc9cbaf0892e023867624dca21f5bfa2" name="afc9cbaf0892e023867624dca21f5bfa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc9cbaf0892e023867624dca21f5bfa2">&#9670;&nbsp;</a></span>ide_read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ide_read </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>d_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="block_8h.html#a5817ce5926a42095888c9518172ec905">block_sector_t</a>&#160;</td>
          <td class="paramname"><em>sec_no</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes. </p>
<p >Internally synchronizes accesses to disks, so external per-disk locking is unneeded. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00345">345</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="input_8c_source.html#l00007">buffer</a>, <a class="el" href="ide_8c_source.html#l00057">ata_disk::channel</a>, <a class="el" href="ide_8c_source.html#l00050">CMD_READ_SECTOR_RETRY</a>, <a class="el" href="ide_8c_source.html#l00073">channel::completion_wait</a>, <a class="el" href="ide_8c_source.html#l00420">input_sector()</a>, <a class="el" href="ide_8c_source.html#l00407">issue_pio_command()</a>, <a class="el" href="ide_8c_source.html#l00070">channel::lock</a>, <a class="el" href="synch_8c_source.html#l00193">lock_acquire()</a>, <a class="el" href="synch_8c_source.html#l00229">lock_release()</a>, <a class="el" href="ide_8c_source.html#l00056">ata_disk::name</a>, <a class="el" href="debug_8h_source.html#l00014">PANIC</a>, <a class="el" href="block_8h_source.html#l00019">PRDSNu</a>, <a class="el" href="ide_8c_source.html#l00389">select_sector()</a>, <a class="el" href="synch_8c_source.html#l00061">sema_down()</a>, and <a class="el" href="ide_8c_source.html#l00460">wait_while_busy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_afc9cbaf0892e023867624dca21f5bfa2_cgraph.png" border="0" usemap="#aide_8c_afc9cbaf0892e023867624dca21f5bfa2_cgraph" alt=""/></div>
<map name="aide_8c_afc9cbaf0892e023867624dca21f5bfa2_cgraph" id="aide_8c_afc9cbaf0892e023867624dca21f5bfa2_cgraph">
<area shape="rect" title="Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes." alt="" coords="5,549,79,576"/>
<area shape="rect" href="ide_8c.html#ad6e24dabc72eca487989a0d9b6fe1347" title="Reads a sector from channel C&#39;s data register in PIO mode into SECTOR, which must have room for BLOCK..." alt="" coords="129,397,224,424"/>
<area shape="rect" href="ide_8c.html#acdfc60cf49c8edf42ed8d25b0d2b6314" title="Writes COMMAND to channel C and prepares for receiving a completion interrupt." alt="" coords="456,853,600,880"/>
<area shape="rect" href="synch_8c.html#aa9021f4c36b4b177c557e0ed8967d048" title="Acquires LOCK, sleeping until it becomes available if necessary." alt="" coords="1129,499,1227,525"/>
<area shape="rect" href="synch_8c.html#ae10ded72d3b93a832b7107566f09286c" title="Down or &quot;P&quot; operation on a semaphore." alt="" coords="1303,549,1396,576"/>
<area shape="rect" href="synch_8c.html#a0616a97ad47869923552432c218f068a" title="Releases LOCK, which must be owned by the current thread." alt="" coords="973,384,1071,411"/>
<area shape="rect" href="ide_8c.html#ad7c31783f9f455b20c35d43f46ee03d8" title="Selects device D, waiting for it to become ready, and then writes SEC_NO to the disk&#39;s sector selecti..." alt="" coords="127,708,227,735"/>
<area shape="rect" href="ide_8c.html#a32d318073c2235e9b03bd77ed17ae580" title="Wait up to 30 seconds for disk D to clear BSY, and then return the status of the DRQ bit." alt="" coords="469,639,587,665"/>
<area shape="rect" href="io_8h.html#a796ec08686cf1380808556b31cabc730" title="Reads CNT 16&#45;bit (halfword) units from PORT, one after another, and stores them into the buffer start..." alt="" coords="317,397,366,424"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1987,701,2088,728"/>
<area shape="rect" href="io_8h.html#a903c588b94e0e8386c8a6f8caa4a5a72" title="Writes byte DATA to PORT." alt="" coords="675,853,723,880"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1815,803,1906,829"/>
<area shape="rect" href="synch_8c.html#a3564cf7ad3b72bee0dd6cdd211ccd666" title="Returns true if the current thread holds LOCK, false otherwise." alt="" coords="1275,179,1424,221"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1631,296,1740,323"/>
<area shape="rect" href="thread_8c.html#a85274904406e17925db793a7603f9c49" title="Initializes the threading system by transforming the code that&#39;s currently running into a thread." alt="" coords="1822,347,1899,373"/>
<area shape="rect" href="thread_8c.html#a42e628208d70ba10d79c26d902b60650" title="Returns the running thread." alt="" coords="1981,397,2093,424"/>
<area shape="rect" href="vaddr_8h.html#a42d21e08e54a8ca6c174c731df74fd3e" title="Round down to nearest page boundary." alt="" coords="2141,397,2259,424"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1640,499,1731,525"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="1477,499,1577,525"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1472,245,1583,272"/>
<area shape="rect" href="thread_8c.html#ad70c4eeb51cd5b0ce2abb939924c7469" title="Puts the current thread to sleep." alt="" coords="1478,600,1577,627"/>
<area shape="rect" href="interrupt_8c.html#a5a896b58d69d8d5ffa7b738c31b924d1" title="Enables interrupts and returns the previous interrupt status." alt="" coords="1641,549,1729,576"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a4ed47fea6462c7db4fde2d0a30e9ce26" title="Returns LIST&#39;s tail." alt="" coords="2443,227,2511,253"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a57866ab170795aa4191fa14fa1c39dd3" title="Inserts ELEM just before BEFORE, which may be either an interior element or a tail." alt="" coords="1646,144,1725,171"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#ae2dec7db343c61370bd42b559ecf80bd" title="Returns true if ELEM is an interior element, false otherwise." alt="" coords="2308,88,2388,115"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#afd128d25023ae454774ad1754af3ee74" title="Returns true if ELEM is a tail, false otherwise." alt="" coords="1833,144,1889,171"/>
<area shape="rect" href="thread_8c.html#a63e3ec45b7bf0028e55f2b9ab1603306" title="Schedules a new process." alt="" coords="1647,448,1723,475"/>
<area shape="rect" href="intq_8c.html#ac473f50d2829cba1321d34a57c425042" title="Returns the position after POS within an intq." alt="" coords="1837,549,1884,576"/>
<area shape="rect" href="thread_8c.html#ace7a46dcf0f5c9c4cbb8f47a5b3c76f5" title="Chooses and returns the next thread to be scheduled." alt="" coords="1792,195,1929,221"/>
<area shape="rect" href="switch_8h.html#a72fbed245d8de7e36d70eb4682682c98" title="Switches from CUR, which must be the running thread, to NEXT, which must also be running switch_threa..." alt="" coords="1805,499,1916,525"/>
<area shape="rect" href="thread_8c.html#acbbd25908c41e62d44a179cfbc3962e2" title="Completes a thread switch by activating the new thread&#39;s page tables, and, if the previous thread is ..." alt="" coords="1788,448,1933,475"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a5591fb615fa4861afb657609792b0777" title="Returns true if LIST is empty, false otherwise." alt="" coords="2307,151,2389,177"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a25d199933dd83abc9cecfe452bf39837" title="Removes the front element from LIST and returns it." alt="" coords="1986,144,2089,171"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a08c9ed5b4d04c46b943f09f84c93064d" title="Returns the beginning of LIST." alt="" coords="2437,151,2516,177"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a3e89b017d033355801dafd955caa8ad0" title="Returns the front element in LIST." alt="" coords="2164,144,2236,171"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a20dc7b49b9631d32e71294ea9cf38e78" title="Removes ELEM from its list and returns the element that followed it." alt="" coords="2155,93,2245,120"/>
<area shape="rect" href="synch_8c.html#a6da4176e1c419bd4467b181c66b077da" title="Up or &quot;V&quot; operation on a semaphore." alt="" coords="1139,384,1217,411"/>
<area shape="rect" href="thread_8c.html#a0cd30c260607aec4597c5b613c5e013f" title="Transitions a blocked thread T to the ready&#45;to&#45;run state." alt="" coords="1293,384,1406,411"/>
<area shape="rect" href="ide_8c.html#a5d8393ec752f120abb30d97b14a69600" title="Select disk D in its channel, as select_device(), but wait for the channel to become idle before and ..." alt="" coords="275,708,408,735"/>
<area shape="rect" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e" title="Program D&#39;s channel so that D is now the selected disk." alt="" coords="477,752,579,779"/>
<area shape="rect" href="ide_8c.html#ac51161a8c0b58de728cb08a3ff722b0f" title="Low&#45;level ATA primitives." alt="" coords="475,701,581,728"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="679,701,719,728"/>
<area shape="rect" href="timer_8c.html#a5d4df9c9580a97f5eee2e70ae8ad43a0" title="Sleeps for approximately NS nanoseconds." alt="" coords="650,803,749,829"/>
<area shape="rect" href="timer_8c.html#a9bd10eb80561359273e022f4c80b483f" title="Sleep for approximately NUM/DENOM seconds." alt="" coords="799,777,915,804"/>
<area shape="rect" href="lib_2stdio_8c.html#a98631211a4a8aee62f572375d5b637be" title="Writes formatted output to the console." alt="" coords="673,600,725,627"/>
<area shape="rect" href="timer_8c.html#ac386900a4e0ba0d6f338b8c5534776d1" title="Sleeps for approximately US microseconds." alt="" coords="650,752,749,779"/>
<area shape="rect" href="kernel_2console_8c.html#aae4ab8b56862ed0a04505cafb8a05112" title="The standard vprintf() function, which is like printf() but uses a va_list." alt="" coords="827,600,886,627"/>
<area shape="rect" href="lib_2stdio_8c.html#a54580ccfcedfa31b4b384cacc8966519" title="Internal functions." alt="" coords="985,651,1059,677"/>
<area shape="rect" href="kernel_2console_8c.html#a69b6a57a329ae666df343a081a51e7a5" title="Acquires the console lock." alt="" coords="963,600,1081,627"/>
<area shape="rect" href="timer_8c.html#a10cbeaa00e0ceb825ddd7a44724881c6" title="Sleeps for approximately MS milliseconds." alt="" coords="648,651,751,677"/>
</map>
</div>

</div>
</div>
<a id="a968318bffbdf3ecb701360fc0ed9cf49" name="a968318bffbdf3ecb701360fc0ed9cf49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a968318bffbdf3ecb701360fc0ed9cf49">&#9670;&nbsp;</a></span>ide_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ide_write </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>d_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="block_8h.html#a5817ce5926a42095888c9518172ec905">block_sector_t</a>&#160;</td>
          <td class="paramname"><em>sec_no</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes. </p>
<p >Returns after the disk has acknowledged receiving the data. Internally synchronizes accesses to disks, so external per-disk locking is unneeded. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00365">365</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="input_8c_source.html#l00007">buffer</a>, <a class="el" href="ide_8c_source.html#l00057">ata_disk::channel</a>, <a class="el" href="ide_8c_source.html#l00051">CMD_WRITE_SECTOR_RETRY</a>, <a class="el" href="ide_8c_source.html#l00073">channel::completion_wait</a>, <a class="el" href="ide_8c_source.html#l00407">issue_pio_command()</a>, <a class="el" href="ide_8c_source.html#l00070">channel::lock</a>, <a class="el" href="synch_8c_source.html#l00193">lock_acquire()</a>, <a class="el" href="synch_8c_source.html#l00229">lock_release()</a>, <a class="el" href="ide_8c_source.html#l00056">ata_disk::name</a>, <a class="el" href="ide_8c_source.html#l00428">output_sector()</a>, <a class="el" href="debug_8h_source.html#l00014">PANIC</a>, <a class="el" href="block_8h_source.html#l00019">PRDSNu</a>, <a class="el" href="ide_8c_source.html#l00389">select_sector()</a>, <a class="el" href="synch_8c_source.html#l00061">sema_down()</a>, and <a class="el" href="ide_8c_source.html#l00460">wait_while_busy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a968318bffbdf3ecb701360fc0ed9cf49_cgraph.png" border="0" usemap="#aide_8c_a968318bffbdf3ecb701360fc0ed9cf49_cgraph" alt=""/></div>
<map name="aide_8c_a968318bffbdf3ecb701360fc0ed9cf49_cgraph" id="aide_8c_a968318bffbdf3ecb701360fc0ed9cf49_cgraph">
<area shape="rect" title="Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes." alt="" coords="5,651,81,677"/>
<area shape="rect" href="ide_8c.html#acdfc60cf49c8edf42ed8d25b0d2b6314" title="Writes COMMAND to channel C and prepares for receiving a completion interrupt." alt="" coords="461,853,605,880"/>
<area shape="rect" href="synch_8c.html#aa9021f4c36b4b177c557e0ed8967d048" title="Acquires LOCK, sleeping until it becomes available if necessary." alt="" coords="1135,499,1232,525"/>
<area shape="rect" href="synch_8c.html#ae10ded72d3b93a832b7107566f09286c" title="Down or &quot;P&quot; operation on a semaphore." alt="" coords="1308,549,1401,576"/>
<area shape="rect" href="synch_8c.html#a0616a97ad47869923552432c218f068a" title="Releases LOCK, which must be owned by the current thread." alt="" coords="979,397,1076,424"/>
<area shape="rect" href="ide_8c.html#a825fd294c52f5c4983939b1d84607a61" title="Writes SECTOR to channel C&#39;s data register in PIO mode." alt="" coords="129,904,232,931"/>
<area shape="rect" href="ide_8c.html#ad7c31783f9f455b20c35d43f46ee03d8" title="Selects device D, waiting for it to become ready, and then writes SEC_NO to the disk&#39;s sector selecti..." alt="" coords="131,727,231,753"/>
<area shape="rect" href="ide_8c.html#a32d318073c2235e9b03bd77ed17ae580" title="Wait up to 30 seconds for disk D to clear BSY, and then return the status of the DRQ bit." alt="" coords="474,651,593,677"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1992,701,2093,728"/>
<area shape="rect" href="io_8h.html#a903c588b94e0e8386c8a6f8caa4a5a72" title="Writes byte DATA to PORT." alt="" coords="681,853,729,880"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1821,803,1911,829"/>
<area shape="rect" href="synch_8c.html#a3564cf7ad3b72bee0dd6cdd211ccd666" title="Returns true if the current thread holds LOCK, false otherwise." alt="" coords="1280,179,1429,221"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1636,296,1745,323"/>
<area shape="rect" href="thread_8c.html#a85274904406e17925db793a7603f9c49" title="Initializes the threading system by transforming the code that&#39;s currently running into a thread." alt="" coords="1827,347,1905,373"/>
<area shape="rect" href="thread_8c.html#a42e628208d70ba10d79c26d902b60650" title="Returns the running thread." alt="" coords="1987,397,2099,424"/>
<area shape="rect" href="vaddr_8h.html#a42d21e08e54a8ca6c174c731df74fd3e" title="Round down to nearest page boundary." alt="" coords="2147,397,2264,424"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1645,499,1736,525"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="1483,499,1583,525"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1477,245,1588,272"/>
<area shape="rect" href="thread_8c.html#ad70c4eeb51cd5b0ce2abb939924c7469" title="Puts the current thread to sleep." alt="" coords="1483,600,1582,627"/>
<area shape="rect" href="interrupt_8c.html#a5a896b58d69d8d5ffa7b738c31b924d1" title="Enables interrupts and returns the previous interrupt status." alt="" coords="1647,549,1735,576"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a4ed47fea6462c7db4fde2d0a30e9ce26" title="Returns LIST&#39;s tail." alt="" coords="2448,227,2516,253"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a57866ab170795aa4191fa14fa1c39dd3" title="Inserts ELEM just before BEFORE, which may be either an interior element or a tail." alt="" coords="1651,144,1730,171"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#ae2dec7db343c61370bd42b559ecf80bd" title="Returns true if ELEM is an interior element, false otherwise." alt="" coords="2313,88,2393,115"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#afd128d25023ae454774ad1754af3ee74" title="Returns true if ELEM is a tail, false otherwise." alt="" coords="1838,144,1894,171"/>
<area shape="rect" href="thread_8c.html#a63e3ec45b7bf0028e55f2b9ab1603306" title="Schedules a new process." alt="" coords="1653,448,1729,475"/>
<area shape="rect" href="intq_8c.html#ac473f50d2829cba1321d34a57c425042" title="Returns the position after POS within an intq." alt="" coords="1843,549,1889,576"/>
<area shape="rect" href="thread_8c.html#ace7a46dcf0f5c9c4cbb8f47a5b3c76f5" title="Chooses and returns the next thread to be scheduled." alt="" coords="1797,195,1935,221"/>
<area shape="rect" href="switch_8h.html#a72fbed245d8de7e36d70eb4682682c98" title="Switches from CUR, which must be the running thread, to NEXT, which must also be running switch_threa..." alt="" coords="1811,499,1921,525"/>
<area shape="rect" href="thread_8c.html#acbbd25908c41e62d44a179cfbc3962e2" title="Completes a thread switch by activating the new thread&#39;s page tables, and, if the previous thread is ..." alt="" coords="1793,448,1939,475"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a5591fb615fa4861afb657609792b0777" title="Returns true if LIST is empty, false otherwise." alt="" coords="2312,151,2395,177"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a25d199933dd83abc9cecfe452bf39837" title="Removes the front element from LIST and returns it." alt="" coords="1991,144,2094,171"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a08c9ed5b4d04c46b943f09f84c93064d" title="Returns the beginning of LIST." alt="" coords="2443,151,2521,177"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a3e89b017d033355801dafd955caa8ad0" title="Returns the front element in LIST." alt="" coords="2169,144,2241,171"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a20dc7b49b9631d32e71294ea9cf38e78" title="Removes ELEM from its list and returns the element that followed it." alt="" coords="2160,93,2251,120"/>
<area shape="rect" href="synch_8c.html#a6da4176e1c419bd4467b181c66b077da" title="Up or &quot;V&quot; operation on a semaphore." alt="" coords="1145,397,1222,424"/>
<area shape="rect" href="thread_8c.html#a0cd30c260607aec4597c5b613c5e013f" title="Transitions a blocked thread T to the ready&#45;to&#45;run state." alt="" coords="1298,397,1411,424"/>
<area shape="rect" href="io_8h.html#a15c5b7146a500280afa7fc8dded78b49" title="Writes to PORT each 16&#45;bit unit (halfword) of data in the CNT&#45;halfword buffer starting at ADDR." alt="" coords="318,904,375,931"/>
<area shape="rect" href="ide_8c.html#a5d8393ec752f120abb30d97b14a69600" title="Select disk D in its channel, as select_device(), but wait for the channel to become idle before and ..." alt="" coords="280,727,413,753"/>
<area shape="rect" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e" title="Program D&#39;s channel so that D is now the selected disk." alt="" coords="482,752,585,779"/>
<area shape="rect" href="ide_8c.html#ac51161a8c0b58de728cb08a3ff722b0f" title="Low&#45;level ATA primitives." alt="" coords="481,701,586,728"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="685,701,725,728"/>
<area shape="rect" href="timer_8c.html#a5d4df9c9580a97f5eee2e70ae8ad43a0" title="Sleeps for approximately NS nanoseconds." alt="" coords="655,803,754,829"/>
<area shape="rect" href="timer_8c.html#a9bd10eb80561359273e022f4c80b483f" title="Sleep for approximately NUM/DENOM seconds." alt="" coords="804,777,920,804"/>
<area shape="rect" href="lib_2stdio_8c.html#a98631211a4a8aee62f572375d5b637be" title="Writes formatted output to the console." alt="" coords="679,600,731,627"/>
<area shape="rect" href="timer_8c.html#ac386900a4e0ba0d6f338b8c5534776d1" title="Sleeps for approximately US microseconds." alt="" coords="655,752,754,779"/>
<area shape="rect" href="kernel_2console_8c.html#aae4ab8b56862ed0a04505cafb8a05112" title="The standard vprintf() function, which is like printf() but uses a va_list." alt="" coords="833,600,891,627"/>
<area shape="rect" href="lib_2stdio_8c.html#a54580ccfcedfa31b4b384cacc8966519" title="Internal functions." alt="" coords="991,651,1064,677"/>
<area shape="rect" href="kernel_2console_8c.html#a69b6a57a329ae666df343a081a51e7a5" title="Acquires the console lock." alt="" coords="968,600,1087,627"/>
<area shape="rect" href="timer_8c.html#a10cbeaa00e0ceb825ddd7a44724881c6" title="Sleeps for approximately MS milliseconds." alt="" coords="653,651,756,677"/>
</map>
</div>

</div>
</div>
<a id="afcd1cfa04037980c000c94c826517759" name="afcd1cfa04037980c000c94c826517759"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcd1cfa04037980c000c94c826517759">&#9670;&nbsp;</a></span>identify_ata_device()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void identify_ata_device </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structata__disk.html">ata_disk</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends an IDENTIFY DEVICE command to disk D and reads the response. </p>
<p >Registers the disk with the block device layer. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00260">260</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="debug_8h_source.html#l00031">ASSERT</a>, <a class="el" href="block_8h_source.html#l00037">BLOCK_RAW</a>, <a class="el" href="block_8c_source.html#l00187">block_register()</a>, <a class="el" href="block_8h_source.html#l00011">BLOCK_SECTOR_SIZE</a>, <a class="el" href="ide_8c_source.html#l00057">ata_disk::channel</a>, <a class="el" href="ide_8c_source.html#l00049">CMD_IDENTIFY_DEVICE</a>, <a class="el" href="ide_8c_source.html#l00073">channel::completion_wait</a>, <a class="el" href="ide_8c_source.html#l00316">descramble_ata_string()</a>, <a class="el" href="ide_8c_source.html#l00082">ide_operations</a>, <a class="el" href="ide_8c_source.html#l00420">input_sector()</a>, <a class="el" href="ide_8c_source.html#l00059">ata_disk::is_ata</a>, <a class="el" href="ide_8c_source.html#l00407">issue_pio_command()</a>, <a class="el" href="ide_8c_source.html#l00056">ata_disk::name</a>, <a class="el" href="partition_8c_source.html#l00028">partition_scan()</a>, <a class="el" href="lib_2stdio_8c_source.html#l00642">print_human_readable_size()</a>, <a class="el" href="lib_2stdio_8c_source.html#l00079">printf()</a>, <a class="el" href="ide_8c_source.html#l00498">select_device_wait()</a>, <a class="el" href="synch_8c_source.html#l00061">sema_down()</a>, <a class="el" href="lib_2stdio_8c_source.html#l00062">snprintf()</a>, and <a class="el" href="ide_8c_source.html#l00460">wait_while_busy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00102">ide_init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_afcd1cfa04037980c000c94c826517759_cgraph.png" border="0" usemap="#aide_8c_afcd1cfa04037980c000c94c826517759_cgraph" alt=""/></div>
<map name="aide_8c_afcd1cfa04037980c000c94c826517759_cgraph" id="aide_8c_afcd1cfa04037980c000c94c826517759_cgraph">
<area shape="rect" title="Sends an IDENTIFY DEVICE command to disk D and reads the response." alt="" coords="5,466,141,493"/>
<area shape="rect" href="block_8c.html#a39d3d6f31410885d66cf8f719339d79d" title="Registers a new block device with the given NAME." alt="" coords="745,314,851,341"/>
<area shape="rect" href="synch_8c.html#ae10ded72d3b93a832b7107566f09286c" title="Down or &quot;P&quot; operation on a semaphore." alt="" coords="1751,302,1844,329"/>
<area shape="rect" href="lib_2stdio_8c.html#a225f673cc2251206f9da043c5a55a80b" title="Prints SIZE, which represents a number of bytes, in a human&#45;readable format, e.g." alt="" coords="899,821,1085,848"/>
<area shape="rect" href="lib_2stdio_8c.html#a98631211a4a8aee62f572375d5b637be" title="Writes formatted output to the console." alt="" coords="1143,745,1195,772"/>
<area shape="rect" href="ide_8c.html#a6a992ae2a2f8f5e9dbaa54b2200a5e44" title="Disk detection and identification." alt="" coords="189,61,347,88"/>
<area shape="rect" href="ide_8c.html#ad6e24dabc72eca487989a0d9b6fe1347" title="Reads a sector from channel C&#39;s data register in PIO mode into SECTOR, which must have room for BLOCK..." alt="" coords="221,112,315,138"/>
<area shape="rect" href="ide_8c.html#acdfc60cf49c8edf42ed8d25b0d2b6314" title="Writes COMMAND to channel C and prepares for receiving a completion interrupt." alt="" coords="395,162,539,189"/>
<area shape="rect" href="partition_8c.html#ae1af155dafc1e46f1725d8061189421a" title="Scans BLOCK for partitions of interest to Pintos." alt="" coords="215,466,321,493"/>
<area shape="rect" href="lib_2stdio_8c.html#a913035b9a30cd1b34c5e587dfbf26f92" title="Like printf(), except that output is stored into BUFFER, which must have space for BUF_SIZE character..." alt="" coords="765,973,831,1000"/>
<area shape="rect" href="ide_8c.html#a5d8393ec752f120abb30d97b14a69600" title="Select disk D in its channel, as select_device(), but wait for the channel to become idle before and ..." alt="" coords="201,720,335,746"/>
<area shape="rect" href="ide_8c.html#a32d318073c2235e9b03bd77ed17ae580" title="Wait up to 30 seconds for disk D to clear BSY, and then return the status of the DRQ bit." alt="" coords="407,872,526,898"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1892,125,2003,152"/>
<area shape="rect" href="malloc_8c.html#a9c36d0fe3ec4675cbffdc9b52f5fb399" title="Obtains and returns a new block of at least SIZE bytes." alt="" coords="1139,353,1199,380"/>
<area shape="rect" href="string_8c.html#a4637af6f79bac4043e1064f0837d0ddc" title="Copies string SRC to DST." alt="" coords="962,213,1022,240"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a4ed47fea6462c7db4fde2d0a30e9ce26" title="Returns LIST&#39;s tail." alt="" coords="2071,176,2139,202"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a57866ab170795aa4191fa14fa1c39dd3" title="Inserts ELEM just before BEFORE, which may be either an interior element or a tail." alt="" coords="2066,125,2145,152"/>
<area shape="rect" href="malloc_8c.html#a9c2a4cff5e437e5be52e507be30eea49" title="Returns the (IDX &#45; 1)&#39;th block within arena A." alt="" coords="1257,581,1370,608"/>
<area shape="rect" href="malloc_8c.html#a5db3c69e2b5fc7fb13fa1f663df2bf03" title="Returns the arena that block B is inside." alt="" coords="1257,530,1370,557"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a5591fb615fa4861afb657609792b0777" title="Returns true if LIST is empty, false otherwise." alt="" coords="1756,188,1839,214"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a25d199933dd83abc9cecfe452bf39837" title="Removes the front element from LIST and returns it." alt="" coords="1262,378,1365,405"/>
<area shape="rect" href="synch_8c.html#aa9021f4c36b4b177c557e0ed8967d048" title="Acquires LOCK, sleeping until it becomes available if necessary." alt="" coords="1605,480,1703,506"/>
<area shape="rect" href="synch_8c.html#a0616a97ad47869923552432c218f068a" title="Releases LOCK, which must be owned by the current thread." alt="" coords="1605,429,1703,456"/>
<area shape="rect" href="palloc_8c.html#a303ef0c7222e4b461dc79f8a90f31bea" title="Obtains and returns a group of PAGE_CNT contiguous free pages." alt="" coords="1421,429,1557,456"/>
<area shape="rect" href="palloc_8c.html#a0c66d7fdb0a9c8da247421261b5ca188" title="Obtains a single free page and returns its kernel virtual address." alt="" coords="1253,429,1373,456"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="2060,505,2151,532"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="2051,378,2160,405"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="2060,252,2151,278"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="1897,277,1997,304"/>
<area shape="rect" href="thread_8c.html#ad70c4eeb51cd5b0ce2abb939924c7469" title="Puts the current thread to sleep." alt="" coords="1898,429,1997,456"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="2208,252,2309,278"/>
<area shape="rect" href="kernel_2console_8c.html#aae4ab8b56862ed0a04505cafb8a05112" title="The standard vprintf() function, which is like printf() but uses a va_list." alt="" coords="1284,745,1343,772"/>
<area shape="rect" href="lib_2stdio_8c.html#a54580ccfcedfa31b4b384cacc8966519" title="Internal functions." alt="" coords="1453,784,1526,810"/>
<area shape="rect" href="kernel_2console_8c.html#a69b6a57a329ae666df343a081a51e7a5" title="Acquires the console lock." alt="" coords="1430,733,1549,760"/>
<area shape="rect" href="string_8c.html#a75301dc67774ade574b3b3205ee4f39e" title="Copies SIZE bytes from SRC to DST, which must not overlap." alt="" coords="1133,245,1205,272"/>
<area shape="rect" href="string_8c.html#a2869404e70f06f4477271f26ce8c4920" title="Returns the length of STRING." alt="" coords="1142,194,1197,221"/>
<area shape="rect" href="ctype_8h.html#a9318513eb3136e55002d65bf602f74a7" title=" " alt="" coords="433,61,500,88"/>
<area shape="rect" href="io_8h.html#a796ec08686cf1380808556b31cabc730" title="Reads CNT 16&#45;bit (halfword) units from PORT, one after another, and stores them into the buffer start..." alt="" coords="442,112,491,138"/>
<area shape="rect" href="io_8h.html#a903c588b94e0e8386c8a6f8caa4a5a72" title="Writes byte DATA to PORT." alt="" coords="618,213,666,240"/>
<area shape="rect" href="block_8c.html#abfb4cd8ff36ddbdf93ebc1944ccfbd4d" title="Returns BLOCK&#39;s name (e.g." alt="" coords="751,365,845,392"/>
<area shape="rect" href="partition_8c.html#a5723d235ee99ff5ebd79a4db49236237" title="Reads the partition table in the given SECTOR of BLOCK and scans it for partitions of interest to Pin..." alt="" coords="397,466,537,493"/>
<area shape="rect" href="block_8c.html#a8c08b3ab03d5cdb52856bab0aafe7006" title="Reads sector SECTOR from BLOCK into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes." alt="" coords="599,365,685,392"/>
<area shape="rect" href="block_8c.html#a66f8a413d9cb3ea11c9cd302f803daea" title="Returns the number of sectors in BLOCK." alt="" coords="756,517,840,544"/>
<area shape="rect" href="partition_8c.html#a80cdac8263b0ada84abe4ddf0adb8614" title="We have found a primary or logical partition of the given TYPE on BLOCK, starting at sector START and..." alt="" coords="587,466,697,493"/>
<area shape="rect" href="malloc_8c.html#a9f850d0608418aea291e4c0fdab93826" title="Frees block P, which must have been previously allocated with malloc(), calloc(), or realloc()." alt="" coords="1147,581,1192,608"/>
<area shape="rect" href="lib_2stdio_8c.html#a1286c6b071007938f54e9b859109f89d" title="Like vprintf(), except that output is stored into BUFFER, which must have space for BUF_SIZE characte..." alt="" coords="956,1074,1028,1101"/>
<area shape="rect" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e" title="Program D&#39;s channel so that D is now the selected disk." alt="" coords="415,720,518,746"/>
<area shape="rect" href="ide_8c.html#ac51161a8c0b58de728cb08a3ff722b0f" title="Low&#45;level ATA primitives." alt="" coords="414,770,519,797"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="622,720,662,746"/>
<area shape="rect" href="timer_8c.html#a10cbeaa00e0ceb825ddd7a44724881c6" title="Sleeps for approximately MS milliseconds." alt="" coords="591,922,693,949"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_afcd1cfa04037980c000c94c826517759_icgraph.png" border="0" usemap="#aide_8c_afcd1cfa04037980c000c94c826517759_icgraph" alt=""/></div>
<map name="aide_8c_afcd1cfa04037980c000c94c826517759_icgraph" id="aide_8c_afcd1cfa04037980c000c94c826517759_icgraph">
<area shape="rect" title="Sends an IDENTIFY DEVICE command to disk D and reads the response." alt="" coords="248,5,384,32"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="136,5,200,32"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,5,88,32"/>
</map>
</div>

</div>
</div>
<a id="ad6e24dabc72eca487989a0d9b6fe1347" name="ad6e24dabc72eca487989a0d9b6fe1347"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6e24dabc72eca487989a0d9b6fe1347">&#9670;&nbsp;</a></span>input_sector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void input_sector </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchannel.html">channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>sector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads a sector from channel C's data register in PIO mode into SECTOR, which must have room for BLOCK_SECTOR_SIZE bytes. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00420">420</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="block_8h_source.html#l00011">BLOCK_SECTOR_SIZE</a>, <a class="el" href="io_8h_source.html#l00039">insw()</a>, and <a class="el" href="ide_8c_source.html#l00017">reg_data</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00345">ide_read()</a>, and <a class="el" href="ide_8c_source.html#l00260">identify_ata_device()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_ad6e24dabc72eca487989a0d9b6fe1347_cgraph.png" border="0" usemap="#aide_8c_ad6e24dabc72eca487989a0d9b6fe1347_cgraph" alt=""/></div>
<map name="aide_8c_ad6e24dabc72eca487989a0d9b6fe1347_cgraph" id="aide_8c_ad6e24dabc72eca487989a0d9b6fe1347_cgraph">
<area shape="rect" title="Reads a sector from channel C&#39;s data register in PIO mode into SECTOR, which must have room for BLOCK..." alt="" coords="5,5,100,32"/>
<area shape="rect" href="io_8h.html#a796ec08686cf1380808556b31cabc730" title="Reads CNT 16&#45;bit (halfword) units from PORT, one after another, and stores them into the buffer start..." alt="" coords="148,5,197,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_ad6e24dabc72eca487989a0d9b6fe1347_icgraph.png" border="0" usemap="#aide_8c_ad6e24dabc72eca487989a0d9b6fe1347_icgraph" alt=""/></div>
<map name="aide_8c_ad6e24dabc72eca487989a0d9b6fe1347_icgraph" id="aide_8c_ad6e24dabc72eca487989a0d9b6fe1347_icgraph">
<area shape="rect" title="Reads a sector from channel C&#39;s data register in PIO mode into SECTOR, which must have room for BLOCK..." alt="" coords="432,31,527,57"/>
<area shape="rect" href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2" title="Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes." alt="" coords="279,5,353,32"/>
<area shape="rect" href="ide_8c.html#afcd1cfa04037980c000c94c826517759" title="Sends an IDENTIFY DEVICE command to disk D and reads the response." alt="" coords="248,56,384,83"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="136,56,200,83"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,56,88,83"/>
</map>
</div>

</div>
</div>
<a id="a968e89e258918c93a81618744b6c0e35" name="a968e89e258918c93a81618744b6c0e35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a968e89e258918c93a81618744b6c0e35">&#9670;&nbsp;</a></span>interrupt_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void interrupt_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structintr__frame.html">intr_frame</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ATA interrupt handler. </p>
<p >&lt; Acknowledge interrupt.</p>
<p >&lt; Wake up waiter.</p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00507">507</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="ide_8c_source.html#l00079">CHANNEL_CNT</a>, <a class="el" href="ide_8c_source.html#l00080">channels</a>, <a class="el" href="ide_8c_source.html#l00073">channel::completion_wait</a>, <a class="el" href="ide_8c_source.html#l00071">channel::expecting_interrupt</a>, <a class="el" href="io_8h_source.html#l00009">inb()</a>, <a class="el" href="ide_8c_source.html#l00068">channel::irq</a>, <a class="el" href="ide_8c_source.html#l00066">channel::name</a>, <a class="el" href="debug_8h_source.html#l00035">NOT_REACHED</a>, <a class="el" href="lib_2stdio_8c_source.html#l00079">printf()</a>, <a class="el" href="ide_8c_source.html#l00024">reg_status</a>, <a class="el" href="synch_8c_source.html#l00109">sema_up()</a>, and <a class="el" href="interrupt_8h_source.html#l00035">intr_frame::vec_no</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00102">ide_init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a968e89e258918c93a81618744b6c0e35_cgraph.png" border="0" usemap="#aide_8c_a968e89e258918c93a81618744b6c0e35_cgraph" alt=""/></div>
<map name="aide_8c_a968e89e258918c93a81618744b6c0e35_cgraph" id="aide_8c_a968e89e258918c93a81618744b6c0e35_cgraph">
<area shape="rect" title="ATA interrupt handler." alt="" coords="5,276,128,303"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="1058,5,1098,32"/>
<area shape="rect" href="lib_2stdio_8c.html#a98631211a4a8aee62f572375d5b637be" title="Writes formatted output to the console." alt="" coords="176,276,228,303"/>
<area shape="rect" href="synch_8c.html#a6da4176e1c419bd4467b181c66b077da" title="Up or &quot;V&quot; operation on a semaphore." alt="" coords="1239,841,1316,868"/>
<area shape="rect" href="kernel_2console_8c.html#aae4ab8b56862ed0a04505cafb8a05112" title="The standard vprintf() function, which is like printf() but uses a va_list." alt="" coords="276,276,335,303"/>
<area shape="rect" href="lib_2stdio_8c.html#a54580ccfcedfa31b4b384cacc8966519" title="Internal functions." alt="" coords="397,879,471,905"/>
<area shape="rect" href="kernel_2console_8c.html#a69b6a57a329ae666df343a081a51e7a5" title="Acquires the console lock." alt="" coords="1019,224,1137,251"/>
<area shape="rect" href="kernel_2console_8c.html#ace2f2e53045fdaa51273a6e45cc63044" title="Releases the console lock." alt="" coords="852,173,971,200"/>
<area shape="rect" href="kernel_2console_8c.html#ada83ac3a119c57c68d54ab7a5c805de3" title="Helper function for vprintf()." alt="" coords="383,483,485,509"/>
<area shape="rect" href="lib_2stdio_8c.html#a1759795abada0ce655326c0754a46c96" title="Wrapper for __vprintf() that converts varargs into a va_list." alt="" coords="567,879,633,905"/>
<area shape="rect" href="lib_2stdio_8c.html#afe54765b33c418c6ceeaea8cc30eea9a" title="Performs an integer conversion, writing output to OUTPUT with auxiliary data AUX." alt="" coords="546,929,654,956"/>
<area shape="rect" href="lib_2stdio_8c.html#afb7ef1a1027f82aa276d48354a0b9218" title="Formats the LENGTH characters starting at STRING according to the conversion specified in C." alt="" coords="550,980,650,1007"/>
<area shape="rect" href="lib_2stdio_8c.html#a6b06e855119acdd96dbc1bf3336cd2c7" title="Parses conversion option characters starting at FORMAT and initializes C appropriately." alt="" coords="537,777,663,804"/>
<area shape="rect" href="string_8c.html#a0862027ba42b443d4ce8ff4a0d9b6459" title="If STRING is less than MAXLEN characters in length, returns its actual length." alt="" coords="569,828,631,855"/>
<area shape="rect" href="lib_2stdio_8c.html#a9248d4643c7dd4c03f632fb1ce2b9d5f" title="Writes CH to OUTPUT with auxiliary data AUX, CNT times." alt="" coords="715,980,804,1007"/>
<area shape="rect" href="ctype_8h.html#ad7fd5ce3790b81c86de5502ff6853f3a" title=" " alt="" coords="731,929,787,956"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1941,309,2032,336"/>
<area shape="rect" href="synch_8c.html#aa9021f4c36b4b177c557e0ed8967d048" title="Acquires LOCK, sleeping until it becomes available if necessary." alt="" coords="1229,465,1326,492"/>
<area shape="rect" href="synch_8c.html#a3564cf7ad3b72bee0dd6cdd211ccd666" title="Returns true if the current thread holds LOCK, false otherwise." alt="" coords="1417,259,1567,301"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1773,512,1883,539"/>
<area shape="rect" href="synch_8c.html#ae10ded72d3b93a832b7107566f09286c" title="Down or &quot;P&quot; operation on a semaphore." alt="" coords="1445,563,1539,589"/>
<area shape="rect" href="thread_8c.html#a85274904406e17925db793a7603f9c49" title="Initializes the threading system by transforming the code that&#39;s currently running into a thread." alt="" coords="1948,588,2025,615"/>
<area shape="rect" href="thread_8c.html#a42e628208d70ba10d79c26d902b60650" title="Returns the running thread." alt="" coords="1931,512,2043,539"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1783,887,1873,913"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="1620,816,1720,843"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1615,664,1725,691"/>
<area shape="rect" href="thread_8c.html#ad70c4eeb51cd5b0ce2abb939924c7469" title="Puts the current thread to sleep." alt="" coords="1621,563,1719,589"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1936,1196,2037,1223"/>
<area shape="rect" href="interrupt_8c.html#a5a896b58d69d8d5ffa7b738c31b924d1" title="Enables interrupts and returns the previous interrupt status." alt="" coords="1784,785,1872,812"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a4ed47fea6462c7db4fde2d0a30e9ce26" title="Returns LIST&#39;s tail." alt="" coords="1953,1016,2021,1043"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a57866ab170795aa4191fa14fa1c39dd3" title="Inserts ELEM just before BEFORE, which may be either an interior element or a tail." alt="" coords="1789,665,1867,692"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#ae2dec7db343c61370bd42b559ecf80bd" title="Returns true if ELEM is an interior element, false otherwise." alt="" coords="1947,840,2027,867"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#afd128d25023ae454774ad1754af3ee74" title="Returns true if ELEM is a tail, false otherwise." alt="" coords="1959,665,2015,692"/>
<area shape="rect" href="synch_8c.html#a0616a97ad47869923552432c218f068a" title="Releases LOCK, which must be owned by the current thread." alt="" coords="1029,385,1127,412"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a5591fb615fa4861afb657609792b0777" title="Returns true if LIST is empty, false otherwise." alt="" coords="1787,1069,1869,1096"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a25d199933dd83abc9cecfe452bf39837" title="Removes the front element from LIST and returns it." alt="" coords="1441,1019,1543,1045"/>
<area shape="rect" href="thread_8c.html#a0cd30c260607aec4597c5b613c5e013f" title="Transitions a blocked thread T to the ready&#45;to&#45;run state." alt="" coords="1435,689,1549,716"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a08c9ed5b4d04c46b943f09f84c93064d" title="Returns the beginning of LIST." alt="" coords="1947,1069,2026,1096"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a3e89b017d033355801dafd955caa8ad0" title="Returns the front element in LIST." alt="" coords="1634,1069,1706,1096"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a20dc7b49b9631d32e71294ea9cf38e78" title="Removes ELEM from its list and returns the element that followed it." alt="" coords="1625,1019,1715,1045"/>
<area shape="rect" href="kernel_2console_8c.html#a5d98987075545c56db87c51597a04bdd" title="Writes C to the vga display and serial port." alt="" coords="533,587,667,613"/>
<area shape="rect" href="kernel_2console_8c.html#ac9311ca129f215c0c8c07cd095a72f2f" title="Returns true if the current thread has the console lock, false otherwise." alt="" coords="1185,197,1369,238"/>
<area shape="rect" href="serial_8c.html#a07c75f3160eed07281583bfaf8eddc1b" title="Sends BYTE to the serial port." alt="" coords="716,639,803,665"/>
<area shape="rect" href="vga_8c.html#a39f191e69844ad1aca267e74223651bd" title="Writes C to the VGA text display, interpreting control characters in the conventional ways." alt="" coords="1454,867,1530,893"/>
<area shape="rect" href="serial_8c.html#aa1fb82a5be4690023966ea841c88a624" title="Initializes the serial port device for polling mode." alt="" coords="878,385,945,412"/>
<area shape="rect" href="intq_8c.html#aff4db6a96c4a1fb6898f26451a1049c2" title="Returns true if Q is full, false otherwise." alt="" coords="1044,841,1112,868"/>
<area shape="rect" href="intq_8c.html#a45ba970f3357ff262d7fafecc50735c6" title="Removes a byte from Q and returns it." alt="" coords="873,487,949,513"/>
<area shape="rect" href="intq_8c.html#a6a440110d5417c12cedf1c2e86f445f8" title="Adds BYTE to the end of Q." alt="" coords="873,639,949,665"/>
<area shape="rect" href="serial_8c.html#a15fd75cc421e6379650204e80853a68a" title="Polls the serial port until it&#39;s ready, and then transmits BYTE." alt="" coords="873,436,949,463"/>
<area shape="rect" href="serial_8c.html#ac89212325aed0ffe38beb0b4bde0bf30" title="Update interrupt enable register." alt="" coords="1241,1373,1313,1400"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a968e89e258918c93a81618744b6c0e35_icgraph.png" border="0" usemap="#aide_8c_a968e89e258918c93a81618744b6c0e35_icgraph" alt=""/></div>
<map name="aide_8c_a968e89e258918c93a81618744b6c0e35_icgraph" id="aide_8c_a968e89e258918c93a81618744b6c0e35_icgraph">
<area shape="rect" title="ATA interrupt handler." alt="" coords="248,5,371,32"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="136,5,200,32"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,5,88,32"/>
</map>
</div>

</div>
</div>
<a id="acdfc60cf49c8edf42ed8d25b0d2b6314" name="acdfc60cf49c8edf42ed8d25b0d2b6314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdfc60cf49c8edf42ed8d25b0d2b6314">&#9670;&nbsp;</a></span>issue_pio_command()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void issue_pio_command </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchannel.html">channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>command</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes COMMAND to channel C and prepares for receiving a completion interrupt. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00407">407</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="debug_8h_source.html#l00031">ASSERT</a>, <a class="el" href="ide_8c_source.html#l00071">channel::expecting_interrupt</a>, <a class="el" href="interrupt_8c_source.html#l00065">intr_get_level()</a>, <a class="el" href="interrupt_8h_source.html#l00011">INTR_ON</a>, <a class="el" href="io_8h_source.html#l00066">outb()</a>, and <a class="el" href="ide_8c_source.html#l00025">reg_command</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00345">ide_read()</a>, <a class="el" href="ide_8c_source.html#l00365">ide_write()</a>, and <a class="el" href="ide_8c_source.html#l00260">identify_ata_device()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_acdfc60cf49c8edf42ed8d25b0d2b6314_cgraph.png" border="0" usemap="#aide_8c_acdfc60cf49c8edf42ed8d25b0d2b6314_cgraph" alt=""/></div>
<map name="aide_8c_acdfc60cf49c8edf42ed8d25b0d2b6314_cgraph" id="aide_8c_acdfc60cf49c8edf42ed8d25b0d2b6314_cgraph">
<area shape="rect" title="Writes COMMAND to channel C and prepares for receiving a completion interrupt." alt="" coords="5,31,149,57"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="197,5,299,32"/>
<area shape="rect" href="io_8h.html#a903c588b94e0e8386c8a6f8caa4a5a72" title="Writes byte DATA to PORT." alt="" coords="224,56,272,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_acdfc60cf49c8edf42ed8d25b0d2b6314_icgraph.png" border="0" usemap="#aide_8c_acdfc60cf49c8edf42ed8d25b0d2b6314_icgraph" alt=""/></div>
<map name="aide_8c_acdfc60cf49c8edf42ed8d25b0d2b6314_icgraph" id="aide_8c_acdfc60cf49c8edf42ed8d25b0d2b6314_icgraph">
<area shape="rect" title="Writes COMMAND to channel C and prepares for receiving a completion interrupt." alt="" coords="432,56,576,83"/>
<area shape="rect" href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2" title="Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes." alt="" coords="279,5,353,32"/>
<area shape="rect" href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49" title="Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes." alt="" coords="278,56,354,83"/>
<area shape="rect" href="ide_8c.html#afcd1cfa04037980c000c94c826517759" title="Sends an IDENTIFY DEVICE command to disk D and reads the response." alt="" coords="248,107,384,133"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="136,107,200,133"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,107,88,133"/>
</map>
</div>

</div>
</div>
<a id="a825fd294c52f5c4983939b1d84607a61" name="a825fd294c52f5c4983939b1d84607a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a825fd294c52f5c4983939b1d84607a61">&#9670;&nbsp;</a></span>output_sector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void output_sector </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchannel.html">channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>sector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes SECTOR to channel C's data register in PIO mode. </p>
<p >SECTOR must contain BLOCK_SECTOR_SIZE bytes. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00428">428</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="block_8h_source.html#l00011">BLOCK_SECTOR_SIZE</a>, <a class="el" href="io_8h_source.html#l00092">outsw()</a>, and <a class="el" href="ide_8c_source.html#l00017">reg_data</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00365">ide_write()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a825fd294c52f5c4983939b1d84607a61_cgraph.png" border="0" usemap="#aide_8c_a825fd294c52f5c4983939b1d84607a61_cgraph" alt=""/></div>
<map name="aide_8c_a825fd294c52f5c4983939b1d84607a61_cgraph" id="aide_8c_a825fd294c52f5c4983939b1d84607a61_cgraph">
<area shape="rect" title="Writes SECTOR to channel C&#39;s data register in PIO mode." alt="" coords="5,5,108,32"/>
<area shape="rect" href="io_8h.html#a15c5b7146a500280afa7fc8dded78b49" title="Writes to PORT each 16&#45;bit unit (halfword) of data in the CNT&#45;halfword buffer starting at ADDR." alt="" coords="156,5,213,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a825fd294c52f5c4983939b1d84607a61_icgraph.png" border="0" usemap="#aide_8c_a825fd294c52f5c4983939b1d84607a61_icgraph" alt=""/></div>
<map name="aide_8c_a825fd294c52f5c4983939b1d84607a61_icgraph" id="aide_8c_a825fd294c52f5c4983939b1d84607a61_icgraph">
<area shape="rect" title="Writes SECTOR to channel C&#39;s data register in PIO mode." alt="" coords="129,5,232,32"/>
<area shape="rect" href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49" title="Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes." alt="" coords="5,5,81,32"/>
</map>
</div>

</div>
</div>
<a id="a03eb0d9954faefcc1634f76a286f78f5" name="a03eb0d9954faefcc1634f76a286f78f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03eb0d9954faefcc1634f76a286f78f5">&#9670;&nbsp;</a></span>reset_channel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void reset_channel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchannel.html">channel</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resets an ATA channel and waits for any devices present on it to finish the reset. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00165">165</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="ide_8c_source.html#l00039">CTL_SRST</a>, <a class="el" href="ide_8c_source.html#l00058">ata_disk::dev_no</a>, <a class="el" href="ide_8c_source.html#l00075">channel::devices</a>, <a class="el" href="io_8h_source.html#l00009">inb()</a>, <a class="el" href="io_8h_source.html#l00066">outb()</a>, <a class="el" href="ide_8c_source.html#l00030">reg_ctl</a>, <a class="el" href="ide_8c_source.html#l00020">reg_lbal</a>, <a class="el" href="ide_8c_source.html#l00019">reg_nsect</a>, <a class="el" href="ide_8c_source.html#l00484">select_device()</a>, <a class="el" href="timer_8c_source.html#l00102">timer_msleep()</a>, <a class="el" href="timer_8c_source.html#l00110">timer_usleep()</a>, and <a class="el" href="ide_8c_source.html#l00460">wait_while_busy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00102">ide_init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a03eb0d9954faefcc1634f76a286f78f5_cgraph.png" border="0" usemap="#aide_8c_a03eb0d9954faefcc1634f76a286f78f5_cgraph" alt=""/></div>
<map name="aide_8c_a03eb0d9954faefcc1634f76a286f78f5_cgraph" id="aide_8c_a03eb0d9954faefcc1634f76a286f78f5_cgraph">
<area shape="rect" title="Resets an ATA channel and waits for any devices present on it to finish the reset." alt="" coords="5,309,111,336"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="357,335,397,361"/>
<area shape="rect" href="io_8h.html#a903c588b94e0e8386c8a6f8caa4a5a72" title="Writes byte DATA to PORT." alt="" coords="353,436,401,463"/>
<area shape="rect" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e" title="Program D&#39;s channel so that D is now the selected disk." alt="" coords="167,385,269,412"/>
<area shape="rect" href="timer_8c.html#a10cbeaa00e0ceb825ddd7a44724881c6" title="Sleeps for approximately MS milliseconds." alt="" coords="325,233,428,260"/>
<area shape="rect" href="timer_8c.html#ac386900a4e0ba0d6f338b8c5534776d1" title="Sleeps for approximately US microseconds." alt="" coords="169,183,267,209"/>
<area shape="rect" href="ide_8c.html#a32d318073c2235e9b03bd77ed17ae580" title="Wait up to 30 seconds for disk D to clear BSY, and then return the status of the DRQ bit." alt="" coords="159,284,277,311"/>
<area shape="rect" href="timer_8c.html#a5d4df9c9580a97f5eee2e70ae8ad43a0" title="Sleeps for approximately NS nanoseconds." alt="" coords="327,385,426,412"/>
<area shape="rect" href="timer_8c.html#a9bd10eb80561359273e022f4c80b483f" title="Sleep for approximately NUM/DENOM seconds." alt="" coords="476,208,592,235"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1543,259,1644,285"/>
<area shape="rect" href="timer_8c.html#a28553fa387ff127de26e330dfcfe9fa1" title="Busy&#45;wait for approximately NUM/DENOM seconds." alt="" coords="641,5,757,32"/>
<area shape="rect" href="timer_8c.html#aa24fbc19fb550d9efd5cabd97489a399" title="Sleeps for approximately TICKS timer ticks." alt="" coords="654,360,745,387"/>
<area shape="rect" href="timer_8c.html#a804190f8e66f39ac2ddb5891de3eec73" title="Iterates through a simple loop LOOPS times, for implementing brief delays." alt="" coords="833,5,914,32"/>
<area shape="rect" href="thread_8c.html#aaa9229e0f462f60bb9550919fa3d7699" title="Yields the CPU." alt="" coords="1015,563,1110,589"/>
<area shape="rect" href="timer_8c.html#a58f1f79abf9bc0515a305ba89c58b9fa" title="Returns the number of timer ticks elapsed since THEN, which should be a value once returned by timer_..." alt="" coords="821,360,926,387"/>
<area shape="rect" href="timer_8c.html#a2b50be77101b38176d21b52cc425cf3e" title="Returns the number of timer ticks since the OS booted." alt="" coords="1020,411,1105,437"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1548,841,1639,868"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1371,461,1462,488"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="1191,512,1291,539"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1185,664,1296,691"/>
<area shape="rect" href="thread_8c.html#a63e3ec45b7bf0028e55f2b9ab1603306" title="Schedules a new process." alt="" coords="1203,335,1279,361"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1186,765,1295,792"/>
<area shape="rect" href="interrupt_8c.html#a5a896b58d69d8d5ffa7b738c31b924d1" title="Enables interrupts and returns the previous interrupt status." alt="" coords="1373,563,1461,589"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a4ed47fea6462c7db4fde2d0a30e9ce26" title="Returns LIST&#39;s tail." alt="" coords="1383,664,1451,691"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a57866ab170795aa4191fa14fa1c39dd3" title="Inserts ELEM just before BEFORE, which may be either an interior element or a tail." alt="" coords="1377,613,1456,640"/>
<area shape="rect" href="thread_8c.html#a85274904406e17925db793a7603f9c49" title="Initializes the threading system by transforming the code that&#39;s currently running into a thread." alt="" coords="1378,512,1455,539"/>
<area shape="rect" href="intq_8c.html#ac473f50d2829cba1321d34a57c425042" title="Returns the position after POS within an intq." alt="" coords="1393,208,1440,235"/>
<area shape="rect" href="thread_8c.html#ace7a46dcf0f5c9c4cbb8f47a5b3c76f5" title="Chooses and returns the next thread to be scheduled." alt="" coords="1348,259,1485,285"/>
<area shape="rect" href="thread_8c.html#a42e628208d70ba10d79c26d902b60650" title="Returns the running thread." alt="" coords="1537,411,1649,437"/>
<area shape="rect" href="switch_8h.html#a72fbed245d8de7e36d70eb4682682c98" title="Switches from CUR, which must be the running thread, to NEXT, which must also be running switch_threa..." alt="" coords="1361,309,1472,336"/>
<area shape="rect" href="thread_8c.html#acbbd25908c41e62d44a179cfbc3962e2" title="Completes a thread switch by activating the new thread&#39;s page tables, and, if the previous thread is ..." alt="" coords="1344,360,1489,387"/>
<area shape="rect" href="lib_2stdio_8c.html#a98631211a4a8aee62f572375d5b637be" title="Writes formatted output to the console." alt="" coords="351,284,403,311"/>
<area shape="rect" href="kernel_2console_8c.html#aae4ab8b56862ed0a04505cafb8a05112" title="The standard vprintf() function, which is like printf() but uses a va_list." alt="" coords="505,740,563,767"/>
<area shape="rect" href="lib_2stdio_8c.html#a54580ccfcedfa31b4b384cacc8966519" title="Internal functions." alt="" coords="663,1120,736,1147"/>
<area shape="rect" href="kernel_2console_8c.html#a69b6a57a329ae666df343a081a51e7a5" title="Acquires the console lock." alt="" coords="640,804,759,831"/>
<area shape="rect" href="kernel_2console_8c.html#ace2f2e53045fdaa51273a6e45cc63044" title="Releases the console lock." alt="" coords="640,740,759,767"/>
<area shape="rect" href="kernel_2console_8c.html#ada83ac3a119c57c68d54ab7a5c805de3" title="Helper function for vprintf()." alt="" coords="648,664,751,691"/>
<area shape="rect" href="lib_2stdio_8c.html#a1759795abada0ce655326c0754a46c96" title="Wrapper for __vprintf() that converts varargs into a va_list." alt="" coords="840,1171,907,1197"/>
<area shape="rect" href="lib_2stdio_8c.html#afe54765b33c418c6ceeaea8cc30eea9a" title="Performs an integer conversion, writing output to OUTPUT with auxiliary data AUX." alt="" coords="819,1221,927,1248"/>
<area shape="rect" href="lib_2stdio_8c.html#afb7ef1a1027f82aa276d48354a0b9218" title="Formats the LENGTH characters starting at STRING according to the conversion specified in C." alt="" coords="823,1069,923,1096"/>
<area shape="rect" href="lib_2stdio_8c.html#a6b06e855119acdd96dbc1bf3336cd2c7" title="Parses conversion option characters starting at FORMAT and initializes C appropriately." alt="" coords="810,1019,937,1045"/>
<area shape="rect" href="string_8c.html#a0862027ba42b443d4ce8ff4a0d9b6459" title="If STRING is less than MAXLEN characters in length, returns its actual length." alt="" coords="842,1120,905,1147"/>
<area shape="rect" href="lib_2stdio_8c.html#a9248d4643c7dd4c03f632fb1ce2b9d5f" title="Writes CH to OUTPUT with auxiliary data AUX, CNT times." alt="" coords="1018,1145,1107,1172"/>
<area shape="rect" href="ctype_8h.html#ad7fd5ce3790b81c86de5502ff6853f3a" title=" " alt="" coords="1035,1019,1091,1045"/>
<area shape="rect" href="synch_8c.html#aa9021f4c36b4b177c557e0ed8967d048" title="Acquires LOCK, sleeping until it becomes available if necessary." alt="" coords="825,816,922,843"/>
<area shape="rect" href="synch_8c.html#a3564cf7ad3b72bee0dd6cdd211ccd666" title="Returns true if the current thread holds LOCK, false otherwise." alt="" coords="988,750,1137,791"/>
<area shape="rect" href="synch_8c.html#ae10ded72d3b93a832b7107566f09286c" title="Down or &quot;P&quot; operation on a semaphore." alt="" coords="1016,681,1109,708"/>
<area shape="rect" href="synch_8c.html#a0616a97ad47869923552432c218f068a" title="Releases LOCK, which must be owned by the current thread." alt="" coords="825,715,922,741"/>
<area shape="rect" href="synch_8c.html#a6da4176e1c419bd4467b181c66b077da" title="Up or &quot;V&quot; operation on a semaphore." alt="" coords="1024,512,1101,539"/>
<area shape="rect" href="kernel_2console_8c.html#a5d98987075545c56db87c51597a04bdd" title="Writes C to the vga display and serial port." alt="" coords="807,664,940,691"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a03eb0d9954faefcc1634f76a286f78f5_icgraph.png" border="0" usemap="#aide_8c_a03eb0d9954faefcc1634f76a286f78f5_icgraph" alt=""/></div>
<map name="aide_8c_a03eb0d9954faefcc1634f76a286f78f5_icgraph" id="aide_8c_a03eb0d9954faefcc1634f76a286f78f5_icgraph">
<area shape="rect" title="Resets an ATA channel and waits for any devices present on it to finish the reset." alt="" coords="248,5,353,32"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="136,5,200,32"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,5,88,32"/>
</map>
</div>

</div>
</div>
<a id="a7252ab4c28b6aed431703ba2b124e05e" name="a7252ab4c28b6aed431703ba2b124e05e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7252ab4c28b6aed431703ba2b124e05e">&#9670;&nbsp;</a></span>select_device()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void select_device </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structata__disk.html">ata_disk</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Program D's channel so that D is now the selected disk. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00484">484</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="ide_8c_source.html#l00057">ata_disk::channel</a>, <a class="el" href="ide_8c_source.html#l00044">DEV_DEV</a>, <a class="el" href="ide_8c_source.html#l00042">DEV_MBS</a>, <a class="el" href="ide_8c_source.html#l00058">ata_disk::dev_no</a>, <a class="el" href="io_8h_source.html#l00009">inb()</a>, <a class="el" href="io_8h_source.html#l00066">outb()</a>, <a class="el" href="ide_8c_source.html#l00031">reg_alt_status</a>, <a class="el" href="ide_8c_source.html#l00023">reg_device</a>, and <a class="el" href="timer_8c_source.html#l00118">timer_nsleep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00230">check_device_type()</a>, <a class="el" href="ide_8c_source.html#l00165">reset_channel()</a>, and <a class="el" href="ide_8c_source.html#l00498">select_device_wait()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a7252ab4c28b6aed431703ba2b124e05e_cgraph.png" border="0" usemap="#aide_8c_a7252ab4c28b6aed431703ba2b124e05e_cgraph" alt=""/></div>
<map name="aide_8c_a7252ab4c28b6aed431703ba2b124e05e_cgraph" id="aide_8c_a7252ab4c28b6aed431703ba2b124e05e_cgraph">
<area shape="rect" title="Program D&#39;s channel so that D is now the selected disk." alt="" coords="5,891,108,918"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="185,841,225,867"/>
<area shape="rect" href="io_8h.html#a903c588b94e0e8386c8a6f8caa4a5a72" title="Writes byte DATA to PORT." alt="" coords="181,891,229,918"/>
<area shape="rect" href="timer_8c.html#a5d4df9c9580a97f5eee2e70ae8ad43a0" title="Sleeps for approximately NS nanoseconds." alt="" coords="156,942,255,969"/>
<area shape="rect" href="timer_8c.html#a9bd10eb80561359273e022f4c80b483f" title="Sleep for approximately NUM/DENOM seconds." alt="" coords="303,942,419,969"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1279,891,1381,918"/>
<area shape="rect" href="timer_8c.html#a28553fa387ff127de26e330dfcfe9fa1" title="Busy&#45;wait for approximately NUM/DENOM seconds." alt="" coords="467,841,583,867"/>
<area shape="rect" href="timer_8c.html#aa24fbc19fb550d9efd5cabd97489a399" title="Sleeps for approximately TICKS timer ticks." alt="" coords="479,942,570,969"/>
<area shape="rect" href="timer_8c.html#a804190f8e66f39ac2ddb5891de3eec73" title="Iterates through a simple loop LOOPS times, for implementing brief delays." alt="" coords="643,815,724,842"/>
<area shape="rect" href="thread_8c.html#aaa9229e0f462f60bb9550919fa3d7699" title="Yields the CPU." alt="" coords="784,815,879,842"/>
<area shape="rect" href="timer_8c.html#a58f1f79abf9bc0515a305ba89c58b9fa" title="Returns the number of timer ticks elapsed since THEN, which should be a value once returned by timer_..." alt="" coords="631,967,736,994"/>
<area shape="rect" href="timer_8c.html#a2b50be77101b38176d21b52cc425cf3e" title="Returns the number of timer ticks since the OS booted." alt="" coords="789,942,874,969"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1285,815,1375,842"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1102,917,1193,943"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="927,866,1027,893"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1275,30,1385,57"/>
<area shape="rect" href="thread_8c.html#a63e3ec45b7bf0028e55f2b9ab1603306" title="Schedules a new process." alt="" coords="939,638,1015,665"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1643,613,1753,639"/>
<area shape="rect" href="interrupt_8c.html#a5a896b58d69d8d5ffa7b738c31b924d1" title="Enables interrupts and returns the previous interrupt status." alt="" coords="1103,866,1191,893"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a4ed47fea6462c7db4fde2d0a30e9ce26" title="Returns LIST&#39;s tail." alt="" coords="1841,30,1909,57"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a57866ab170795aa4191fa14fa1c39dd3" title="Inserts ELEM just before BEFORE, which may be either an interior element or a tail." alt="" coords="1471,30,1549,57"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#ae2dec7db343c61370bd42b559ecf80bd" title="Returns true if ELEM is an interior element, false otherwise." alt="" coords="1658,81,1738,107"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#afd128d25023ae454774ad1754af3ee74" title="Returns true if ELEM is a tail, false otherwise." alt="" coords="1670,30,1726,57"/>
<area shape="rect" href="thread_8c.html#a85274904406e17925db793a7603f9c49" title="Initializes the threading system by transforming the code that&#39;s currently running into a thread." alt="" coords="1837,511,1914,538"/>
<area shape="rect" href="intq_8c.html#ac473f50d2829cba1321d34a57c425042" title="Returns the position after POS within an intq." alt="" coords="1124,613,1171,639"/>
<area shape="rect" href="thread_8c.html#ace7a46dcf0f5c9c4cbb8f47a5b3c76f5" title="Chooses and returns the next thread to be scheduled." alt="" coords="1079,182,1216,209"/>
<area shape="rect" href="thread_8c.html#a42e628208d70ba10d79c26d902b60650" title="Returns the running thread." alt="" coords="1819,613,1931,639"/>
<area shape="rect" href="switch_8h.html#a72fbed245d8de7e36d70eb4682682c98" title="Switches from CUR, which must be the running thread, to NEXT, which must also be running switch_threa..." alt="" coords="1092,663,1203,690"/>
<area shape="rect" href="thread_8c.html#acbbd25908c41e62d44a179cfbc3962e2" title="Completes a thread switch by activating the new thread&#39;s page tables, and, if the previous thread is ..." alt="" coords="1075,714,1220,741"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a5591fb615fa4861afb657609792b0777" title="Returns true if LIST is empty, false otherwise." alt="" coords="1657,131,1739,158"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a25d199933dd83abc9cecfe452bf39837" title="Removes the front element from LIST and returns it." alt="" coords="1279,131,1381,158"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a08c9ed5b4d04c46b943f09f84c93064d" title="Returns the beginning of LIST." alt="" coords="1836,131,1915,158"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a3e89b017d033355801dafd955caa8ad0" title="Returns the front element in LIST." alt="" coords="1474,131,1546,158"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a20dc7b49b9631d32e71294ea9cf38e78" title="Removes ELEM from its list and returns the element that followed it." alt="" coords="1465,81,1555,107"/>
<area shape="rect" href="vaddr_8h.html#a42d21e08e54a8ca6c174c731df74fd3e" title="Round down to nearest page boundary." alt="" coords="1983,613,2100,639"/>
<area shape="rect" href="palloc_8c.html#ad3fe56f7c611216596e7565fb8521409" title="Frees the page at PAGE." alt="" coords="1268,373,1392,399"/>
<area shape="rect" href="process_8c.html#a23823b283ef2815ecc5ae19e772dac24" title="Sets up the CPU for running user code in the current thread." alt="" coords="1269,689,1391,715"/>
<area shape="rect" href="palloc_8c.html#af4c2af0e0bdc81d1ea21354c4234b20e" title="Frees the PAGE_CNT pages starting at PAGES." alt="" coords="1440,334,1580,361"/>
<area shape="rect" href="bitmap_8c.html#ab8910020ce78e389457c0607990d04d3" title="Returns true if every bit in B between START and START + CNT, exclusive, is set to true,..." alt="" coords="1657,283,1739,310"/>
<area shape="rect" href="bitmap_8c.html#a7b2eaaf4ee3c0f7794b4e5293f3b9760" title="Sets the CNT bits starting at START in B to VALUE." alt="" coords="1628,385,1768,411"/>
<area shape="rect" href="string_8c.html#a32f4138a368f78ed6d4339e679641261" title="Sets the SIZE bytes in DST to VALUE." alt="" coords="1663,334,1733,361"/>
<area shape="rect" href="palloc_8c.html#a2adf802e51d008838946d621cb4e8fb2" title="Returns true if PAGE was allocated from POOL, false otherwise." alt="" coords="1639,182,1757,209"/>
<area shape="rect" href="vaddr_8h.html#a1efae7b168a7e2234c0e4022d889bdc8" title="Virtual page number." alt="" coords="1846,233,1905,259"/>
<area shape="rect" href="vaddr_8h.html#ac12acb882dfd1a70e6c8f69935dc3747" title="Offset within a page." alt="" coords="1667,435,1729,462"/>
<area shape="rect" href="bitmap_8c.html#a90f5f9e5e7afbd943d0c6c33fc0d8557" title="Returns true if any bits in B between START and START + CNT, exclusive, are set to VALUE,..." alt="" coords="1816,283,1935,310"/>
<area shape="rect" href="bitmap_8c.html#a766a7941acc1371fb82ed4f70a1ecf37" title="Setting and testing single bits." alt="" coords="1832,385,1919,411"/>
<area shape="rect" href="bitmap_8c.html#a576f7d29f091eac024f70ae8d68997a9" title="Bitmap size." alt="" coords="1829,182,1922,209"/>
<area shape="rect" href="pagedir_8c.html#ac0a75950cc56724fef94d224df4b0cd0" title="Loads page directory PD into the CPU&#39;s page directory base register." alt="" coords="1450,714,1570,741"/>
<area shape="rect" href="tss_8c.html#a089f0d1278964a0cc36f92d47febd2d4" title="Sets the ring 0 stack pointer in the TSS to point to the end of the thread stack." alt="" coords="1467,663,1553,690"/>
<area shape="rect" href="vaddr_8h.html#a0f6ff2f4a18892d83d6e1c1a3c2d9f9b" title="Returns physical address at which kernel virtual address VADDR is mapped." alt="" coords="1675,714,1721,741"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a7252ab4c28b6aed431703ba2b124e05e_icgraph.png" border="0" usemap="#aide_8c_a7252ab4c28b6aed431703ba2b124e05e_icgraph" alt=""/></div>
<map name="aide_8c_a7252ab4c28b6aed431703ba2b124e05e_icgraph" id="aide_8c_a7252ab4c28b6aed431703ba2b124e05e_icgraph">
<area shape="rect" title="Program D&#39;s channel so that D is now the selected disk." alt="" coords="625,56,728,83"/>
<area shape="rect" href="ide_8c.html#afb1b543e585d7b5757bf9406b8705349" title="Checks whether device D is an ATA disk and sets D&#39;s is_ata member appropriately." alt="" coords="260,5,396,32"/>
<area shape="rect" href="ide_8c.html#a03eb0d9954faefcc1634f76a286f78f5" title="Resets an ATA channel and waits for any devices present on it to finish the reset." alt="" coords="458,56,563,83"/>
<area shape="rect" href="ide_8c.html#a5d8393ec752f120abb30d97b14a69600" title="Select disk D in its channel, as select_device(), but wait for the channel to become idle before and ..." alt="" coords="444,107,577,133"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="142,56,206,83"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,56,88,83"/>
<area shape="rect" href="ide_8c.html#afcd1cfa04037980c000c94c826517759" title="Sends an IDENTIFY DEVICE command to disk D and reads the response." alt="" coords="260,107,396,133"/>
<area shape="rect" href="ide_8c.html#ad7c31783f9f455b20c35d43f46ee03d8" title="Selects device D, waiting for it to become ready, and then writes SEC_NO to the disk&#39;s sector selecti..." alt="" coords="278,157,378,184"/>
<area shape="rect" href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2" title="Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes." alt="" coords="137,132,211,159"/>
<area shape="rect" href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49" title="Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes." alt="" coords="136,183,212,209"/>
</map>
</div>

</div>
</div>
<a id="a5d8393ec752f120abb30d97b14a69600" name="a5d8393ec752f120abb30d97b14a69600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d8393ec752f120abb30d97b14a69600">&#9670;&nbsp;</a></span>select_device_wait()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void select_device_wait </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structata__disk.html">ata_disk</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Select disk D in its channel, as <a class="el" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e" title="Program D&#39;s channel so that D is now the selected disk.">select_device()</a>, but wait for the channel to become idle before and after. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00498">498</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="ide_8c_source.html#l00484">select_device()</a>, and <a class="el" href="ide_8c_source.html#l00441">wait_until_idle()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00260">identify_ata_device()</a>, and <a class="el" href="ide_8c_source.html#l00389">select_sector()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a5d8393ec752f120abb30d97b14a69600_cgraph.png" border="0" usemap="#aide_8c_a5d8393ec752f120abb30d97b14a69600_cgraph" alt=""/></div>
<map name="aide_8c_a5d8393ec752f120abb30d97b14a69600_cgraph" id="aide_8c_a5d8393ec752f120abb30d97b14a69600_cgraph">
<area shape="rect" title="Select disk D in its channel, as select_device(), but wait for the channel to become idle before and ..." alt="" coords="5,933,139,960"/>
<area shape="rect" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e" title="Program D&#39;s channel so that D is now the selected disk." alt="" coords="188,959,291,985"/>
<area shape="rect" href="ide_8c.html#ac51161a8c0b58de728cb08a3ff722b0f" title="Low&#45;level ATA primitives." alt="" coords="187,896,292,923"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="369,933,409,960"/>
<area shape="rect" href="io_8h.html#a903c588b94e0e8386c8a6f8caa4a5a72" title="Writes byte DATA to PORT." alt="" coords="365,1035,413,1061"/>
<area shape="rect" href="timer_8c.html#a5d4df9c9580a97f5eee2e70ae8ad43a0" title="Sleeps for approximately NS nanoseconds." alt="" coords="340,984,439,1011"/>
<area shape="rect" href="timer_8c.html#a9bd10eb80561359273e022f4c80b483f" title="Sleep for approximately NUM/DENOM seconds." alt="" coords="487,984,603,1011"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1603,807,1705,833"/>
<area shape="rect" href="timer_8c.html#a28553fa387ff127de26e330dfcfe9fa1" title="Busy&#45;wait for approximately NUM/DENOM seconds." alt="" coords="652,1085,768,1112"/>
<area shape="rect" href="timer_8c.html#aa24fbc19fb550d9efd5cabd97489a399" title="Sleeps for approximately TICKS timer ticks." alt="" coords="665,933,755,960"/>
<area shape="rect" href="timer_8c.html#a804190f8e66f39ac2ddb5891de3eec73" title="Iterates through a simple loop LOOPS times, for implementing brief delays." alt="" coords="843,1085,925,1112"/>
<area shape="rect" href="thread_8c.html#aaa9229e0f462f60bb9550919fa3d7699" title="Yields the CPU." alt="" coords="1043,680,1138,707"/>
<area shape="rect" href="timer_8c.html#a58f1f79abf9bc0515a305ba89c58b9fa" title="Returns the number of timer ticks elapsed since THEN, which should be a value once returned by timer_..." alt="" coords="831,883,937,909"/>
<area shape="rect" href="timer_8c.html#a2b50be77101b38176d21b52cc425cf3e" title="Returns the number of timer ticks since the OS booted." alt="" coords="1048,917,1133,944"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1609,208,1699,235"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1437,807,1528,833"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="1255,781,1355,808"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1250,309,1361,336"/>
<area shape="rect" href="thread_8c.html#a63e3ec45b7bf0028e55f2b9ab1603306" title="Schedules a new process." alt="" coords="1445,629,1521,656"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1428,499,1537,525"/>
<area shape="rect" href="interrupt_8c.html#a5a896b58d69d8d5ffa7b738c31b924d1" title="Enables interrupts and returns the previous interrupt status." alt="" coords="1439,756,1527,783"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a4ed47fea6462c7db4fde2d0a30e9ce26" title="Returns LIST&#39;s tail." alt="" coords="1449,360,1517,387"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a57866ab170795aa4191fa14fa1c39dd3" title="Inserts ELEM just before BEFORE, which may be either an interior element or a tail." alt="" coords="1443,309,1522,336"/>
<area shape="rect" href="thread_8c.html#a85274904406e17925db793a7603f9c49" title="Initializes the threading system by transforming the code that&#39;s currently running into a thread." alt="" coords="1615,571,1693,597"/>
<area shape="rect" href="intq_8c.html#ac473f50d2829cba1321d34a57c425042" title="Returns the position after POS within an intq." alt="" coords="1631,625,1677,652"/>
<area shape="rect" href="thread_8c.html#ace7a46dcf0f5c9c4cbb8f47a5b3c76f5" title="Chooses and returns the next thread to be scheduled." alt="" coords="1585,676,1723,703"/>
<area shape="rect" href="thread_8c.html#a42e628208d70ba10d79c26d902b60650" title="Returns the running thread." alt="" coords="1598,513,1710,540"/>
<area shape="rect" href="lib_2stdio_8c.html#a98631211a4a8aee62f572375d5b637be" title="Writes formatted output to the console." alt="" coords="363,723,415,749"/>
<area shape="rect" href="timer_8c.html#ac386900a4e0ba0d6f338b8c5534776d1" title="Sleeps for approximately US microseconds." alt="" coords="340,883,439,909"/>
<area shape="rect" href="kernel_2console_8c.html#aae4ab8b56862ed0a04505cafb8a05112" title="The standard vprintf() function, which is like printf() but uses a va_list." alt="" coords="515,613,574,640"/>
<area shape="rect" href="lib_2stdio_8c.html#a54580ccfcedfa31b4b384cacc8966519" title="Internal functions." alt="" coords="673,613,747,640"/>
<area shape="rect" href="kernel_2console_8c.html#a69b6a57a329ae666df343a081a51e7a5" title="Acquires the console lock." alt="" coords="651,360,769,387"/>
<area shape="rect" href="kernel_2console_8c.html#ace2f2e53045fdaa51273a6e45cc63044" title="Releases the console lock." alt="" coords="651,461,769,488"/>
<area shape="rect" href="kernel_2console_8c.html#ada83ac3a119c57c68d54ab7a5c805de3" title="Helper function for vprintf()." alt="" coords="659,740,761,767"/>
<area shape="rect" href="lib_2stdio_8c.html#a1759795abada0ce655326c0754a46c96" title="Wrapper for __vprintf() that converts varargs into a va_list." alt="" coords="851,613,917,640"/>
<area shape="rect" href="lib_2stdio_8c.html#afe54765b33c418c6ceeaea8cc30eea9a" title="Performs an integer conversion, writing output to OUTPUT with auxiliary data AUX." alt="" coords="830,512,938,539"/>
<area shape="rect" href="lib_2stdio_8c.html#afb7ef1a1027f82aa276d48354a0b9218" title="Formats the LENGTH characters starting at STRING according to the conversion specified in C." alt="" coords="834,664,934,691"/>
<area shape="rect" href="lib_2stdio_8c.html#a6b06e855119acdd96dbc1bf3336cd2c7" title="Parses conversion option characters starting at FORMAT and initializes C appropriately." alt="" coords="821,715,947,741"/>
<area shape="rect" href="string_8c.html#a0862027ba42b443d4ce8ff4a0d9b6459" title="If STRING is less than MAXLEN characters in length, returns its actual length." alt="" coords="853,563,915,589"/>
<area shape="rect" href="lib_2stdio_8c.html#a9248d4643c7dd4c03f632fb1ce2b9d5f" title="Writes CH to OUTPUT with auxiliary data AUX, CNT times." alt="" coords="1046,512,1135,539"/>
<area shape="rect" href="ctype_8h.html#ad7fd5ce3790b81c86de5502ff6853f3a" title=" " alt="" coords="1063,563,1119,589"/>
<area shape="rect" href="synch_8c.html#aa9021f4c36b4b177c557e0ed8967d048" title="Acquires LOCK, sleeping until it becomes available if necessary." alt="" coords="835,309,933,336"/>
<area shape="rect" href="synch_8c.html#a3564cf7ad3b72bee0dd6cdd211ccd666" title="Returns true if the current thread holds LOCK, false otherwise." alt="" coords="1231,462,1380,503"/>
<area shape="rect" href="synch_8c.html#ae10ded72d3b93a832b7107566f09286c" title="Down or &quot;P&quot; operation on a semaphore." alt="" coords="1044,309,1137,336"/>
<area shape="rect" href="synch_8c.html#a0616a97ad47869923552432c218f068a" title="Releases LOCK, which must be owned by the current thread." alt="" coords="835,461,933,488"/>
<area shape="rect" href="synch_8c.html#a6da4176e1c419bd4467b181c66b077da" title="Up or &quot;V&quot; operation on a semaphore." alt="" coords="1052,731,1129,757"/>
<area shape="rect" href="kernel_2console_8c.html#a5d98987075545c56db87c51597a04bdd" title="Writes C to the vga display and serial port." alt="" coords="817,816,951,843"/>
<area shape="rect" href="kernel_2console_8c.html#ac9311ca129f215c0c8c07cd095a72f2f" title="Returns true if the current thread has the console lock, false otherwise." alt="" coords="999,614,1183,655"/>
<area shape="rect" href="serial_8c.html#a07c75f3160eed07281583bfaf8eddc1b" title="Sends BYTE to the serial port." alt="" coords="1047,799,1134,825"/>
<area shape="rect" href="vga_8c.html#a39f191e69844ad1aca267e74223651bd" title="Writes C to the VGA text display, interpreting control characters in the conventional ways." alt="" coords="1053,849,1129,876"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a5d8393ec752f120abb30d97b14a69600_icgraph.png" border="0" usemap="#aide_8c_a5d8393ec752f120abb30d97b14a69600_icgraph" alt=""/></div>
<map name="aide_8c_a5d8393ec752f120abb30d97b14a69600_icgraph" id="aide_8c_a5d8393ec752f120abb30d97b14a69600_icgraph">
<area shape="rect" title="Select disk D in its channel, as select_device(), but wait for the channel to become idle before and ..." alt="" coords="444,31,577,57"/>
<area shape="rect" href="ide_8c.html#afcd1cfa04037980c000c94c826517759" title="Sends an IDENTIFY DEVICE command to disk D and reads the response." alt="" coords="260,5,396,32"/>
<area shape="rect" href="ide_8c.html#ad7c31783f9f455b20c35d43f46ee03d8" title="Selects device D, waiting for it to become ready, and then writes SEC_NO to the disk&#39;s sector selecti..." alt="" coords="278,56,378,83"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="142,5,206,32"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,5,88,32"/>
<area shape="rect" href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2" title="Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes." alt="" coords="137,56,211,83"/>
<area shape="rect" href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49" title="Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes." alt="" coords="136,107,212,133"/>
</map>
</div>

</div>
</div>
<a id="ad7c31783f9f455b20c35d43f46ee03d8" name="ad7c31783f9f455b20c35d43f46ee03d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7c31783f9f455b20c35d43f46ee03d8">&#9670;&nbsp;</a></span>select_sector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void select_sector </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structata__disk.html">ata_disk</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="block_8h.html#a5817ce5926a42095888c9518172ec905">block_sector_t</a>&#160;</td>
          <td class="paramname"><em>sec_no</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Selects device D, waiting for it to become ready, and then writes SEC_NO to the disk's sector selection registers. </p>
<p >(We use LBA mode.) </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00389">389</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="debug_8h_source.html#l00031">ASSERT</a>, <a class="el" href="ide_8c_source.html#l00057">ata_disk::channel</a>, <a class="el" href="ide_8c_source.html#l00044">DEV_DEV</a>, <a class="el" href="ide_8c_source.html#l00043">DEV_LBA</a>, <a class="el" href="ide_8c_source.html#l00042">DEV_MBS</a>, <a class="el" href="ide_8c_source.html#l00058">ata_disk::dev_no</a>, <a class="el" href="io_8h_source.html#l00066">outb()</a>, <a class="el" href="ide_8c_source.html#l00023">reg_device</a>, <a class="el" href="ide_8c_source.html#l00022">reg_lbah</a>, <a class="el" href="ide_8c_source.html#l00020">reg_lbal</a>, <a class="el" href="ide_8c_source.html#l00021">reg_lbam</a>, <a class="el" href="ide_8c_source.html#l00019">reg_nsect</a>, and <a class="el" href="ide_8c_source.html#l00498">select_device_wait()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00345">ide_read()</a>, and <a class="el" href="ide_8c_source.html#l00365">ide_write()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_ad7c31783f9f455b20c35d43f46ee03d8_cgraph.png" border="0" usemap="#aide_8c_ad7c31783f9f455b20c35d43f46ee03d8_cgraph" alt=""/></div>
<map name="aide_8c_ad7c31783f9f455b20c35d43f46ee03d8_cgraph" id="aide_8c_ad7c31783f9f455b20c35d43f46ee03d8_cgraph">
<area shape="rect" title="Selects device D, waiting for it to become ready, and then writes SEC_NO to the disk&#39;s sector selecti..." alt="" coords="5,144,105,171"/>
<area shape="rect" href="io_8h.html#a903c588b94e0e8386c8a6f8caa4a5a72" title="Writes byte DATA to PORT." alt="" coords="513,119,561,145"/>
<area shape="rect" href="ide_8c.html#a5d8393ec752f120abb30d97b14a69600" title="Select disk D in its channel, as select_device(), but wait for the channel to become idle before and ..." alt="" coords="153,169,287,196"/>
<area shape="rect" href="ide_8c.html#a7252ab4c28b6aed431703ba2b124e05e" title="Program D&#39;s channel so that D is now the selected disk." alt="" coords="336,169,439,196"/>
<area shape="rect" href="ide_8c.html#ac51161a8c0b58de728cb08a3ff722b0f" title="Low&#45;level ATA primitives." alt="" coords="335,245,440,272"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="517,220,557,247"/>
<area shape="rect" href="timer_8c.html#a5d4df9c9580a97f5eee2e70ae8ad43a0" title="Sleeps for approximately NS nanoseconds." alt="" coords="488,169,587,196"/>
<area shape="rect" href="timer_8c.html#a9bd10eb80561359273e022f4c80b483f" title="Sleep for approximately NUM/DENOM seconds." alt="" coords="635,169,751,196"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1751,245,1853,272"/>
<area shape="rect" href="timer_8c.html#a28553fa387ff127de26e330dfcfe9fa1" title="Busy&#45;wait for approximately NUM/DENOM seconds." alt="" coords="800,220,916,247"/>
<area shape="rect" href="timer_8c.html#aa24fbc19fb550d9efd5cabd97489a399" title="Sleeps for approximately TICKS timer ticks." alt="" coords="813,144,903,171"/>
<area shape="rect" href="timer_8c.html#a804190f8e66f39ac2ddb5891de3eec73" title="Iterates through a simple loop LOOPS times, for implementing brief delays." alt="" coords="991,245,1073,272"/>
<area shape="rect" href="thread_8c.html#aaa9229e0f462f60bb9550919fa3d7699" title="Yields the CPU." alt="" coords="1191,448,1286,475"/>
<area shape="rect" href="timer_8c.html#a58f1f79abf9bc0515a305ba89c58b9fa" title="Returns the number of timer ticks elapsed since THEN, which should be a value once returned by timer_..." alt="" coords="979,144,1085,171"/>
<area shape="rect" href="timer_8c.html#a2b50be77101b38176d21b52cc425cf3e" title="Returns the number of timer ticks since the OS booted." alt="" coords="1196,119,1281,145"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1757,803,1847,829"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1585,245,1676,272"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="1403,296,1503,323"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1398,499,1509,525"/>
<area shape="rect" href="thread_8c.html#a63e3ec45b7bf0028e55f2b9ab1603306" title="Schedules a new process." alt="" coords="1593,321,1669,348"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1576,651,1685,677"/>
<area shape="rect" href="interrupt_8c.html#a5a896b58d69d8d5ffa7b738c31b924d1" title="Enables interrupts and returns the previous interrupt status." alt="" coords="1587,372,1675,399"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a4ed47fea6462c7db4fde2d0a30e9ce26" title="Returns LIST&#39;s tail." alt="" coords="1597,499,1665,525"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a57866ab170795aa4191fa14fa1c39dd3" title="Inserts ELEM just before BEFORE, which may be either an interior element or a tail." alt="" coords="1591,448,1670,475"/>
<area shape="rect" href="thread_8c.html#a85274904406e17925db793a7603f9c49" title="Initializes the threading system by transforming the code that&#39;s currently running into a thread." alt="" coords="1763,524,1841,551"/>
<area shape="rect" href="intq_8c.html#ac473f50d2829cba1321d34a57c425042" title="Returns the position after POS within an intq." alt="" coords="1779,296,1825,323"/>
<area shape="rect" href="thread_8c.html#ace7a46dcf0f5c9c4cbb8f47a5b3c76f5" title="Chooses and returns the next thread to be scheduled." alt="" coords="1733,347,1871,373"/>
<area shape="rect" href="lib_2stdio_8c.html#a98631211a4a8aee62f572375d5b637be" title="Writes formatted output to the console." alt="" coords="511,473,563,500"/>
<area shape="rect" href="timer_8c.html#ac386900a4e0ba0d6f338b8c5534776d1" title="Sleeps for approximately US microseconds." alt="" coords="488,271,587,297"/>
<area shape="rect" href="kernel_2console_8c.html#aae4ab8b56862ed0a04505cafb8a05112" title="The standard vprintf() function, which is like printf() but uses a va_list." alt="" coords="663,549,722,576"/>
<area shape="rect" href="lib_2stdio_8c.html#a54580ccfcedfa31b4b384cacc8966519" title="Internal functions." alt="" coords="821,448,895,475"/>
<area shape="rect" href="kernel_2console_8c.html#a69b6a57a329ae666df343a081a51e7a5" title="Acquires the console lock." alt="" coords="799,819,917,845"/>
<area shape="rect" href="kernel_2console_8c.html#ace2f2e53045fdaa51273a6e45cc63044" title="Releases the console lock." alt="" coords="799,549,917,576"/>
<area shape="rect" href="kernel_2console_8c.html#ada83ac3a119c57c68d54ab7a5c805de3" title="Helper function for vprintf()." alt="" coords="807,600,909,627"/>
<area shape="rect" href="lib_2stdio_8c.html#a1759795abada0ce655326c0754a46c96" title="Wrapper for __vprintf() that converts varargs into a va_list." alt="" coords="999,448,1065,475"/>
<area shape="rect" href="lib_2stdio_8c.html#afe54765b33c418c6ceeaea8cc30eea9a" title="Performs an integer conversion, writing output to OUTPUT with auxiliary data AUX." alt="" coords="978,347,1086,373"/>
<area shape="rect" href="lib_2stdio_8c.html#afb7ef1a1027f82aa276d48354a0b9218" title="Formats the LENGTH characters starting at STRING according to the conversion specified in C." alt="" coords="982,296,1082,323"/>
<area shape="rect" href="lib_2stdio_8c.html#a6b06e855119acdd96dbc1bf3336cd2c7" title="Parses conversion option characters starting at FORMAT and initializes C appropriately." alt="" coords="969,499,1095,525"/>
<area shape="rect" href="string_8c.html#a0862027ba42b443d4ce8ff4a0d9b6459" title="If STRING is less than MAXLEN characters in length, returns its actual length." alt="" coords="1001,397,1063,424"/>
<area shape="rect" href="lib_2stdio_8c.html#a9248d4643c7dd4c03f632fb1ce2b9d5f" title="Writes CH to OUTPUT with auxiliary data AUX, CNT times." alt="" coords="1194,195,1283,221"/>
<area shape="rect" href="ctype_8h.html#ad7fd5ce3790b81c86de5502ff6853f3a" title=" " alt="" coords="1211,245,1267,272"/>
<area shape="rect" href="synch_8c.html#aa9021f4c36b4b177c557e0ed8967d048" title="Acquires LOCK, sleeping until it becomes available if necessary." alt="" coords="983,768,1081,795"/>
<area shape="rect" href="synch_8c.html#a3564cf7ad3b72bee0dd6cdd211ccd666" title="Returns true if the current thread holds LOCK, false otherwise." alt="" coords="1379,854,1528,895"/>
<area shape="rect" href="synch_8c.html#ae10ded72d3b93a832b7107566f09286c" title="Down or &quot;P&quot; operation on a semaphore." alt="" coords="1192,549,1285,576"/>
<area shape="rect" href="synch_8c.html#a0616a97ad47869923552432c218f068a" title="Releases LOCK, which must be owned by the current thread." alt="" coords="983,549,1081,576"/>
<area shape="rect" href="synch_8c.html#a6da4176e1c419bd4467b181c66b077da" title="Up or &quot;V&quot; operation on a semaphore." alt="" coords="1200,296,1277,323"/>
<area shape="rect" href="kernel_2console_8c.html#a5d98987075545c56db87c51597a04bdd" title="Writes C to the vga display and serial port." alt="" coords="965,600,1099,627"/>
<area shape="rect" href="kernel_2console_8c.html#ac9311ca129f215c0c8c07cd095a72f2f" title="Returns true if the current thread has the console lock, false otherwise." alt="" coords="1147,702,1331,743"/>
<area shape="rect" href="serial_8c.html#a07c75f3160eed07281583bfaf8eddc1b" title="Sends BYTE to the serial port." alt="" coords="1195,347,1282,373"/>
<area shape="rect" href="vga_8c.html#a39f191e69844ad1aca267e74223651bd" title="Writes C to the VGA text display, interpreting control characters in the conventional ways." alt="" coords="1201,397,1277,424"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_ad7c31783f9f455b20c35d43f46ee03d8_icgraph.png" border="0" usemap="#aide_8c_ad7c31783f9f455b20c35d43f46ee03d8_icgraph" alt=""/></div>
<map name="aide_8c_ad7c31783f9f455b20c35d43f46ee03d8_icgraph" id="aide_8c_ad7c31783f9f455b20c35d43f46ee03d8_icgraph">
<area shape="rect" title="Selects device D, waiting for it to become ready, and then writes SEC_NO to the disk&#39;s sector selecti..." alt="" coords="129,31,229,57"/>
<area shape="rect" href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2" title="Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes." alt="" coords="7,5,80,32"/>
<area shape="rect" href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49" title="Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes." alt="" coords="5,56,81,83"/>
</map>
</div>

</div>
</div>
<a id="ac51161a8c0b58de728cb08a3ff722b0f" name="ac51161a8c0b58de728cb08a3ff722b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac51161a8c0b58de728cb08a3ff722b0f">&#9670;&nbsp;</a></span>wait_until_idle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void wait_until_idle </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structata__disk.html">ata_disk</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Low-level ATA primitives. </p>
<p >Wait up to 10 seconds for the controller to become idle, that is, for the BSY and DRQ bits to clear in the status register.</p>
<p >As a side effect, reading the status register clears any pending interrupt. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00441">441</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="ide_8c_source.html#l00057">ata_disk::channel</a>, <a class="el" href="io_8h_source.html#l00009">inb()</a>, <a class="el" href="ide_8c_source.html#l00056">ata_disk::name</a>, <a class="el" href="lib_2stdio_8c_source.html#l00079">printf()</a>, <a class="el" href="ide_8c_source.html#l00024">reg_status</a>, <a class="el" href="ide_8c_source.html#l00034">STA_BSY</a>, <a class="el" href="ide_8c_source.html#l00036">STA_DRQ</a>, and <a class="el" href="timer_8c_source.html#l00110">timer_usleep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00498">select_device_wait()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_ac51161a8c0b58de728cb08a3ff722b0f_cgraph.png" border="0" usemap="#aide_8c_ac51161a8c0b58de728cb08a3ff722b0f_cgraph" alt=""/></div>
<map name="aide_8c_ac51161a8c0b58de728cb08a3ff722b0f_cgraph" id="aide_8c_ac51161a8c0b58de728cb08a3ff722b0f_cgraph">
<area shape="rect" title="Low&#45;level ATA primitives." alt="" coords="5,1523,111,1550"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="1120,1523,1160,1550"/>
<area shape="rect" href="lib_2stdio_8c.html#a98631211a4a8aee62f572375d5b637be" title="Writes formatted output to the console." alt="" coords="182,941,234,967"/>
<area shape="rect" href="timer_8c.html#ac386900a4e0ba0d6f338b8c5534776d1" title="Sleeps for approximately US microseconds." alt="" coords="159,1574,257,1601"/>
<area shape="rect" href="kernel_2console_8c.html#aae4ab8b56862ed0a04505cafb8a05112" title="The standard vprintf() function, which is like printf() but uses a va_list." alt="" coords="305,379,364,406"/>
<area shape="rect" href="lib_2stdio_8c.html#a54580ccfcedfa31b4b384cacc8966519" title="Internal functions." alt="" coords="427,177,500,203"/>
<area shape="rect" href="kernel_2console_8c.html#a69b6a57a329ae666df343a081a51e7a5" title="Acquires the console lock." alt="" coords="881,270,1000,297"/>
<area shape="rect" href="kernel_2console_8c.html#ace2f2e53045fdaa51273a6e45cc63044" title="Releases the console lock." alt="" coords="881,379,1000,406"/>
<area shape="rect" href="kernel_2console_8c.html#ada83ac3a119c57c68d54ab7a5c805de3" title="Helper function for vprintf()." alt="" coords="412,590,515,617"/>
<area shape="rect" href="lib_2stdio_8c.html#a1759795abada0ce655326c0754a46c96" title="Wrapper for __vprintf() that converts varargs into a va_list." alt="" coords="596,177,663,203"/>
<area shape="rect" href="lib_2stdio_8c.html#afe54765b33c418c6ceeaea8cc30eea9a" title="Performs an integer conversion, writing output to OUTPUT with auxiliary data AUX." alt="" coords="575,126,683,153"/>
<area shape="rect" href="lib_2stdio_8c.html#afb7ef1a1027f82aa276d48354a0b9218" title="Formats the LENGTH characters starting at STRING according to the conversion specified in C." alt="" coords="579,75,679,102"/>
<area shape="rect" href="lib_2stdio_8c.html#a6b06e855119acdd96dbc1bf3336cd2c7" title="Parses conversion option characters starting at FORMAT and initializes C appropriately." alt="" coords="566,227,693,254"/>
<area shape="rect" href="string_8c.html#a0862027ba42b443d4ce8ff4a0d9b6459" title="If STRING is less than MAXLEN characters in length, returns its actual length." alt="" coords="598,278,661,305"/>
<area shape="rect" href="lib_2stdio_8c.html#a9248d4643c7dd4c03f632fb1ce2b9d5f" title="Writes CH to OUTPUT with auxiliary data AUX, CNT times." alt="" coords="744,101,833,127"/>
<area shape="rect" href="ctype_8h.html#ad7fd5ce3790b81c86de5502ff6853f3a" title=" " alt="" coords="761,227,817,254"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1649,307,1739,334"/>
<area shape="rect" href="synch_8c.html#aa9021f4c36b4b177c557e0ed8967d048" title="Acquires LOCK, sleeping until it becomes available if necessary." alt="" coords="1091,358,1189,385"/>
<area shape="rect" href="synch_8c.html#a3564cf7ad3b72bee0dd6cdd211ccd666" title="Returns true if the current thread holds LOCK, false otherwise." alt="" coords="1280,257,1429,299"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1639,510,1749,537"/>
<area shape="rect" href="synch_8c.html#ae10ded72d3b93a832b7107566f09286c" title="Down or &quot;P&quot; operation on a semaphore." alt="" coords="1308,561,1401,587"/>
<area shape="rect" href="thread_8c.html#a85274904406e17925db793a7603f9c49" title="Initializes the threading system by transforming the code that&#39;s currently running into a thread." alt="" coords="1815,611,1892,638"/>
<area shape="rect" href="thread_8c.html#a42e628208d70ba10d79c26d902b60650" title="Returns the running thread." alt="" coords="1797,510,1909,537"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1808,1017,1899,1043"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="1644,1017,1744,1043"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1639,713,1749,739"/>
<area shape="rect" href="thread_8c.html#ad70c4eeb51cd5b0ce2abb939924c7469" title="Puts the current thread to sleep." alt="" coords="1485,510,1583,537"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1957,1321,2059,1347"/>
<area shape="rect" href="thread_8c.html#a63e3ec45b7bf0028e55f2b9ab1603306" title="Schedules a new process." alt="" coords="1656,561,1732,587"/>
<area shape="rect" href="synch_8c.html#a0616a97ad47869923552432c218f068a" title="Releases LOCK, which must be owned by the current thread." alt="" coords="1091,409,1189,435"/>
<area shape="rect" href="synch_8c.html#a6da4176e1c419bd4467b181c66b077da" title="Up or &quot;V&quot; operation on a semaphore." alt="" coords="1316,890,1393,917"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a5591fb615fa4861afb657609792b0777" title="Returns true if LIST is empty, false otherwise." alt="" coords="1493,865,1575,891"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a25d199933dd83abc9cecfe452bf39837" title="Removes the front element from LIST and returns it." alt="" coords="1483,915,1585,942"/>
<area shape="rect" href="thread_8c.html#a0cd30c260607aec4597c5b613c5e013f" title="Transitions a blocked thread T to the ready&#45;to&#45;run state." alt="" coords="1477,763,1591,790"/>
<area shape="rect" href="kernel_2console_8c.html#a5d98987075545c56db87c51597a04bdd" title="Writes C to the vga display and serial port." alt="" coords="563,858,696,885"/>
<area shape="rect" href="kernel_2console_8c.html#ac9311ca129f215c0c8c07cd095a72f2f" title="Returns true if the current thread has the console lock, false otherwise." alt="" coords="1048,173,1232,215"/>
<area shape="rect" href="serial_8c.html#a07c75f3160eed07281583bfaf8eddc1b" title="Sends BYTE to the serial port." alt="" coords="745,991,832,1018"/>
<area shape="rect" href="vga_8c.html#a39f191e69844ad1aca267e74223651bd" title="Writes C to the VGA text display, interpreting control characters in the conventional ways." alt="" coords="1496,1169,1572,1195"/>
<area shape="rect" href="serial_8c.html#aa1fb82a5be4690023966ea841c88a624" title="Initializes the serial port device for polling mode." alt="" coords="907,966,974,993"/>
<area shape="rect" href="intq_8c.html#aff4db6a96c4a1fb6898f26451a1049c2" title="Returns true if Q is full, false otherwise." alt="" coords="1106,1422,1174,1449"/>
<area shape="rect" href="intq_8c.html#a45ba970f3357ff262d7fafecc50735c6" title="Removes a byte from Q and returns it." alt="" coords="903,481,979,507"/>
<area shape="rect" href="intq_8c.html#a6a440110d5417c12cedf1c2e86f445f8" title="Adds BYTE to the end of Q." alt="" coords="903,709,979,735"/>
<area shape="rect" href="serial_8c.html#a15fd75cc421e6379650204e80853a68a" title="Polls the serial port until it&#39;s ready, and then transmits BYTE." alt="" coords="903,1473,979,1499"/>
<area shape="rect" href="timer_8c.html#a9bd10eb80561359273e022f4c80b483f" title="Sleep for approximately NUM/DENOM seconds." alt="" coords="883,1574,999,1601"/>
<area shape="rect" href="timer_8c.html#a28553fa387ff127de26e330dfcfe9fa1" title="Busy&#45;wait for approximately NUM/DENOM seconds." alt="" coords="1082,1625,1198,1651"/>
<area shape="rect" href="timer_8c.html#aa24fbc19fb550d9efd5cabd97489a399" title="Sleeps for approximately TICKS timer ticks." alt="" coords="1095,1219,1185,1246"/>
<area shape="rect" href="timer_8c.html#a804190f8e66f39ac2ddb5891de3eec73" title="Iterates through a simple loop LOOPS times, for implementing brief delays." alt="" coords="1314,1625,1395,1651"/>
<area shape="rect" href="thread_8c.html#aaa9229e0f462f60bb9550919fa3d7699" title="Yields the CPU." alt="" coords="1487,662,1581,689"/>
<area shape="rect" href="timer_8c.html#a58f1f79abf9bc0515a305ba89c58b9fa" title="Returns the number of timer ticks elapsed since THEN, which should be a value once returned by timer_..." alt="" coords="1302,1219,1407,1246"/>
<area shape="rect" href="timer_8c.html#a2b50be77101b38176d21b52cc425cf3e" title="Returns the number of timer ticks since the OS booted." alt="" coords="1491,1219,1577,1246"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_ac51161a8c0b58de728cb08a3ff722b0f_icgraph.png" border="0" usemap="#aide_8c_ac51161a8c0b58de728cb08a3ff722b0f_icgraph" alt=""/></div>
<map name="aide_8c_ac51161a8c0b58de728cb08a3ff722b0f_icgraph" id="aide_8c_ac51161a8c0b58de728cb08a3ff722b0f_icgraph">
<area shape="rect" title="Low&#45;level ATA primitives." alt="" coords="625,31,731,57"/>
<area shape="rect" href="ide_8c.html#a5d8393ec752f120abb30d97b14a69600" title="Select disk D in its channel, as select_device(), but wait for the channel to become idle before and ..." alt="" coords="444,31,577,57"/>
<area shape="rect" href="ide_8c.html#afcd1cfa04037980c000c94c826517759" title="Sends an IDENTIFY DEVICE command to disk D and reads the response." alt="" coords="260,5,396,32"/>
<area shape="rect" href="ide_8c.html#ad7c31783f9f455b20c35d43f46ee03d8" title="Selects device D, waiting for it to become ready, and then writes SEC_NO to the disk&#39;s sector selecti..." alt="" coords="278,56,378,83"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="142,5,206,32"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,5,88,32"/>
<area shape="rect" href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2" title="Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes." alt="" coords="137,56,211,83"/>
<area shape="rect" href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49" title="Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes." alt="" coords="136,107,212,133"/>
</map>
</div>

</div>
</div>
<a id="a32d318073c2235e9b03bd77ed17ae580" name="a32d318073c2235e9b03bd77ed17ae580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32d318073c2235e9b03bd77ed17ae580">&#9670;&nbsp;</a></span>wait_while_busy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> wait_while_busy </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structata__disk.html">ata_disk</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wait up to 30 seconds for disk D to clear BSY, and then return the status of the DRQ bit. </p>
<p >The ATA standards say that a disk may take as long as that to complete its reset. </p>

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00460">460</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">References <a class="el" href="ide_8c_source.html#l00057">ata_disk::channel</a>, <a class="el" href="io_8h_source.html#l00009">inb()</a>, <a class="el" href="ide_8c_source.html#l00056">ata_disk::name</a>, <a class="el" href="lib_2stdio_8c_source.html#l00079">printf()</a>, <a class="el" href="ide_8c_source.html#l00031">reg_alt_status</a>, <a class="el" href="ide_8c_source.html#l00034">STA_BSY</a>, <a class="el" href="ide_8c_source.html#l00036">STA_DRQ</a>, and <a class="el" href="timer_8c_source.html#l00102">timer_msleep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00345">ide_read()</a>, <a class="el" href="ide_8c_source.html#l00365">ide_write()</a>, <a class="el" href="ide_8c_source.html#l00260">identify_ata_device()</a>, and <a class="el" href="ide_8c_source.html#l00165">reset_channel()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a32d318073c2235e9b03bd77ed17ae580_cgraph.png" border="0" usemap="#aide_8c_a32d318073c2235e9b03bd77ed17ae580_cgraph" alt=""/></div>
<map name="aide_8c_a32d318073c2235e9b03bd77ed17ae580_cgraph" id="aide_8c_a32d318073c2235e9b03bd77ed17ae580_cgraph">
<area shape="rect" title="Wait up to 30 seconds for disk D to clear BSY, and then return the status of the DRQ bit." alt="" coords="5,1523,124,1550"/>
<area shape="rect" href="io_8h.html#a0223c8898dfec29069879dc51076e28a" title="Reads and returns a byte from PORT." alt="" coords="1137,1523,1177,1550"/>
<area shape="rect" href="lib_2stdio_8c.html#a98631211a4a8aee62f572375d5b637be" title="Writes formatted output to the console." alt="" coords="197,941,249,967"/>
<area shape="rect" href="timer_8c.html#a10cbeaa00e0ceb825ddd7a44724881c6" title="Sleeps for approximately MS milliseconds." alt="" coords="172,1574,275,1601"/>
<area shape="rect" href="kernel_2console_8c.html#aae4ab8b56862ed0a04505cafb8a05112" title="The standard vprintf() function, which is like printf() but uses a va_list." alt="" coords="323,379,381,406"/>
<area shape="rect" href="lib_2stdio_8c.html#a54580ccfcedfa31b4b384cacc8966519" title="Internal functions." alt="" coords="444,177,517,203"/>
<area shape="rect" href="kernel_2console_8c.html#a69b6a57a329ae666df343a081a51e7a5" title="Acquires the console lock." alt="" coords="899,270,1017,297"/>
<area shape="rect" href="kernel_2console_8c.html#ace2f2e53045fdaa51273a6e45cc63044" title="Releases the console lock." alt="" coords="899,379,1017,406"/>
<area shape="rect" href="kernel_2console_8c.html#ada83ac3a119c57c68d54ab7a5c805de3" title="Helper function for vprintf()." alt="" coords="429,590,532,617"/>
<area shape="rect" href="lib_2stdio_8c.html#a1759795abada0ce655326c0754a46c96" title="Wrapper for __vprintf() that converts varargs into a va_list." alt="" coords="613,177,680,203"/>
<area shape="rect" href="lib_2stdio_8c.html#afe54765b33c418c6ceeaea8cc30eea9a" title="Performs an integer conversion, writing output to OUTPUT with auxiliary data AUX." alt="" coords="593,126,701,153"/>
<area shape="rect" href="lib_2stdio_8c.html#afb7ef1a1027f82aa276d48354a0b9218" title="Formats the LENGTH characters starting at STRING according to the conversion specified in C." alt="" coords="597,75,697,102"/>
<area shape="rect" href="lib_2stdio_8c.html#a6b06e855119acdd96dbc1bf3336cd2c7" title="Parses conversion option characters starting at FORMAT and initializes C appropriately." alt="" coords="583,227,710,254"/>
<area shape="rect" href="string_8c.html#a0862027ba42b443d4ce8ff4a0d9b6459" title="If STRING is less than MAXLEN characters in length, returns its actual length." alt="" coords="615,278,678,305"/>
<area shape="rect" href="lib_2stdio_8c.html#a9248d4643c7dd4c03f632fb1ce2b9d5f" title="Writes CH to OUTPUT with auxiliary data AUX, CNT times." alt="" coords="761,101,851,127"/>
<area shape="rect" href="ctype_8h.html#ad7fd5ce3790b81c86de5502ff6853f3a" title=" " alt="" coords="778,227,834,254"/>
<area shape="rect" href="interrupt_8c.html#ab253c940fea3774ac64e8c53b05a57a2" title="Returns true during processing of an external interrupt and false at all other times." alt="" coords="1666,307,1757,334"/>
<area shape="rect" href="synch_8c.html#aa9021f4c36b4b177c557e0ed8967d048" title="Acquires LOCK, sleeping until it becomes available if necessary." alt="" coords="1109,358,1206,385"/>
<area shape="rect" href="synch_8c.html#a3564cf7ad3b72bee0dd6cdd211ccd666" title="Returns true if the current thread holds LOCK, false otherwise." alt="" coords="1297,257,1447,299"/>
<area shape="rect" href="thread_8c.html#a0032becedd11c8a8e10a0a6955c90d66" title="Returns the running thread." alt="" coords="1657,510,1766,537"/>
<area shape="rect" href="synch_8c.html#ae10ded72d3b93a832b7107566f09286c" title="Down or &quot;P&quot; operation on a semaphore." alt="" coords="1325,561,1419,587"/>
<area shape="rect" href="thread_8c.html#a85274904406e17925db793a7603f9c49" title="Initializes the threading system by transforming the code that&#39;s currently running into a thread." alt="" coords="1832,611,1909,638"/>
<area shape="rect" href="thread_8c.html#a42e628208d70ba10d79c26d902b60650" title="Returns the running thread." alt="" coords="1815,510,1927,537"/>
<area shape="rect" href="interrupt_8c.html#abb2fa56d0ab9adc628c697b6190430c3" title="Disables interrupts and returns the previous interrupt status." alt="" coords="1825,1017,1916,1043"/>
<area shape="rect" href="interrupt_8c.html#ae3ae93a45d368c3d64fd0b473bd303d0" title="Enables or disables interrupts as specified by LEVEL and returns the previous interrupt status." alt="" coords="1661,1017,1761,1043"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a997639d9e16bed1f4a450c0bdf7959ba" title="Inserts ELEM at the end of LIST, so that it becomes the back in LIST." alt="" coords="1656,713,1767,739"/>
<area shape="rect" href="thread_8c.html#ad70c4eeb51cd5b0ce2abb939924c7469" title="Puts the current thread to sleep." alt="" coords="1502,510,1601,537"/>
<area shape="rect" href="interrupt_8c.html#ac657e1386ac8c557ddafbcc732427fbf" title="Returns the current interrupt status." alt="" coords="1975,1321,2076,1347"/>
<area shape="rect" href="thread_8c.html#a63e3ec45b7bf0028e55f2b9ab1603306" title="Schedules a new process." alt="" coords="1673,561,1749,587"/>
<area shape="rect" href="synch_8c.html#a0616a97ad47869923552432c218f068a" title="Releases LOCK, which must be owned by the current thread." alt="" coords="1109,409,1206,435"/>
<area shape="rect" href="synch_8c.html#a6da4176e1c419bd4467b181c66b077da" title="Up or &quot;V&quot; operation on a semaphore." alt="" coords="1333,890,1411,917"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a5591fb615fa4861afb657609792b0777" title="Returns true if LIST is empty, false otherwise." alt="" coords="1510,865,1593,891"/>
<area shape="rect" href="lib_2kernel_2list_8c.html#a25d199933dd83abc9cecfe452bf39837" title="Removes the front element from LIST and returns it." alt="" coords="1500,915,1603,942"/>
<area shape="rect" href="thread_8c.html#a0cd30c260607aec4597c5b613c5e013f" title="Transitions a blocked thread T to the ready&#45;to&#45;run state." alt="" coords="1495,763,1608,790"/>
<area shape="rect" href="kernel_2console_8c.html#a5d98987075545c56db87c51597a04bdd" title="Writes C to the vga display and serial port." alt="" coords="580,858,713,885"/>
<area shape="rect" href="kernel_2console_8c.html#ac9311ca129f215c0c8c07cd095a72f2f" title="Returns true if the current thread has the console lock, false otherwise." alt="" coords="1065,173,1249,215"/>
<area shape="rect" href="serial_8c.html#a07c75f3160eed07281583bfaf8eddc1b" title="Sends BYTE to the serial port." alt="" coords="763,991,849,1018"/>
<area shape="rect" href="vga_8c.html#a39f191e69844ad1aca267e74223651bd" title="Writes C to the VGA text display, interpreting control characters in the conventional ways." alt="" coords="1513,1169,1589,1195"/>
<area shape="rect" href="serial_8c.html#aa1fb82a5be4690023966ea841c88a624" title="Initializes the serial port device for polling mode." alt="" coords="925,966,991,993"/>
<area shape="rect" href="intq_8c.html#aff4db6a96c4a1fb6898f26451a1049c2" title="Returns true if Q is full, false otherwise." alt="" coords="1123,1422,1191,1449"/>
<area shape="rect" href="intq_8c.html#a45ba970f3357ff262d7fafecc50735c6" title="Removes a byte from Q and returns it." alt="" coords="920,481,996,507"/>
<area shape="rect" href="intq_8c.html#a6a440110d5417c12cedf1c2e86f445f8" title="Adds BYTE to the end of Q." alt="" coords="920,709,996,735"/>
<area shape="rect" href="serial_8c.html#a15fd75cc421e6379650204e80853a68a" title="Polls the serial port until it&#39;s ready, and then transmits BYTE." alt="" coords="920,1473,996,1499"/>
<area shape="rect" href="timer_8c.html#a9bd10eb80561359273e022f4c80b483f" title="Sleep for approximately NUM/DENOM seconds." alt="" coords="900,1574,1016,1601"/>
<area shape="rect" href="timer_8c.html#a28553fa387ff127de26e330dfcfe9fa1" title="Busy&#45;wait for approximately NUM/DENOM seconds." alt="" coords="1099,1625,1215,1651"/>
<area shape="rect" href="timer_8c.html#aa24fbc19fb550d9efd5cabd97489a399" title="Sleeps for approximately TICKS timer ticks." alt="" coords="1112,1219,1203,1246"/>
<area shape="rect" href="timer_8c.html#a804190f8e66f39ac2ddb5891de3eec73" title="Iterates through a simple loop LOOPS times, for implementing brief delays." alt="" coords="1331,1625,1413,1651"/>
<area shape="rect" href="thread_8c.html#aaa9229e0f462f60bb9550919fa3d7699" title="Yields the CPU." alt="" coords="1504,662,1599,689"/>
<area shape="rect" href="timer_8c.html#a58f1f79abf9bc0515a305ba89c58b9fa" title="Returns the number of timer ticks elapsed since THEN, which should be a value once returned by timer_..." alt="" coords="1319,1219,1425,1246"/>
<area shape="rect" href="timer_8c.html#a2b50be77101b38176d21b52cc425cf3e" title="Returns the number of timer ticks since the OS booted." alt="" coords="1509,1219,1594,1246"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ide_8c_a32d318073c2235e9b03bd77ed17ae580_icgraph.png" border="0" usemap="#aide_8c_a32d318073c2235e9b03bd77ed17ae580_icgraph" alt=""/></div>
<map name="aide_8c_a32d318073c2235e9b03bd77ed17ae580_icgraph" id="aide_8c_a32d318073c2235e9b03bd77ed17ae580_icgraph">
<area shape="rect" title="Wait up to 30 seconds for disk D to clear BSY, and then return the status of the DRQ bit." alt="" coords="432,81,551,108"/>
<area shape="rect" href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2" title="Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes." alt="" coords="279,5,353,32"/>
<area shape="rect" href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49" title="Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes." alt="" coords="278,56,354,83"/>
<area shape="rect" href="ide_8c.html#afcd1cfa04037980c000c94c826517759" title="Sends an IDENTIFY DEVICE command to disk D and reads the response." alt="" coords="248,107,384,133"/>
<area shape="rect" href="ide_8c.html#a03eb0d9954faefcc1634f76a286f78f5" title="Resets an ATA channel and waits for any devices present on it to finish the reset." alt="" coords="263,157,369,184"/>
<area shape="rect" href="ide_8c.html#a5e8e1409e0675bdd93040403c52dd660" title="Initialize the disk subsystem and detect disks." alt="" coords="136,132,200,159"/>
<area shape="rect" href="init_8c.html#a597a4e36419870df906ed14699bf47c7" title="Pintos main entry point." alt="" coords="5,132,88,159"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ae81c6d1c941d4f5fac5cfd5c2a26283c" name="ae81c6d1c941d4f5fac5cfd5c2a26283c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae81c6d1c941d4f5fac5cfd5c2a26283c">&#9670;&nbsp;</a></span>channels</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structchannel.html">channel</a> channels[<a class="el" href="ide_8c.html#aed31f8d4617249f3a96e6038e652194e">CHANNEL_CNT</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00080">80</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00102">ide_init()</a>, and <a class="el" href="ide_8c_source.html#l00507">interrupt_handler()</a>.</p>

</div>
</div>
<a id="a023601e9a8f1fc769aa9d2243f10ed95" name="a023601e9a8f1fc769aa9d2243f10ed95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a023601e9a8f1fc769aa9d2243f10ed95">&#9670;&nbsp;</a></span>ide_operations</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structblock__operations.html">block_operations</a> ide_operations</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">  {</div>
<div class="line">    <a class="code hl_function" href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2">ide_read</a>,</div>
<div class="line">    <a class="code hl_function" href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49">ide_write</a></div>
<div class="line">  }</div>
<div class="ttc" id="aide_8c_html_a968318bffbdf3ecb701360fc0ed9cf49"><div class="ttname"><a href="ide_8c.html#a968318bffbdf3ecb701360fc0ed9cf49">ide_write</a></div><div class="ttdeci">static void ide_write(void *d_, block_sector_t sec_no, const void *buffer)</div><div class="ttdoc">Write sector SEC_NO to disk D from BUFFER, which must contain BLOCK_SECTOR_SIZE bytes.</div><div class="ttdef"><b>Definition:</b> <a href="ide_8c_source.html#l00365">ide.c:365</a></div></div>
<div class="ttc" id="aide_8c_html_afc9cbaf0892e023867624dca21f5bfa2"><div class="ttname"><a href="ide_8c.html#afc9cbaf0892e023867624dca21f5bfa2">ide_read</a></div><div class="ttdeci">static void ide_read(void *d_, block_sector_t sec_no, void *buffer)</div><div class="ttdoc">Reads sector SEC_NO from disk D into BUFFER, which must have room for BLOCK_SECTOR_SIZE bytes.</div><div class="ttdef"><b>Definition:</b> <a href="ide_8c_source.html#l00345">ide.c:345</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="ide_8c_source.html#l00082">82</a> of file <a class="el" href="ide_8c_source.html">ide.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ide_8c_source.html#l00260">identify_ata_device()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 4 2021 19:31:02 for PKUOS - Pintos by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
